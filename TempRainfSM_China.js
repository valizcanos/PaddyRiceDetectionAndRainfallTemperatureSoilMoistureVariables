var NdviEvi = ee.ImageCollection("MODIS/006/MOD13Q1"),
    Ndwi = ee.ImageCollection("MODIS/MCD43A4_006_NDWI"),
    WaterMask = ee.Image("MODIS/MOD44W/MOD44W_005_2000_02_24"),
    Croplands = ee.Image("USGS/GFSAD1000_V0"),
    Center = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Point([112.0888853667166, 29.53008305449045]),
    Hunan = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[111.73423549689416, 29.18976994955696],
          [112.89878627814416, 29.18976994955696],
          [112.89878627814416, 29.958936721360907],
          [111.73423549689416, 29.958936721360907],
          [111.73423549689416, 29.18976994955696]]]),
    crops1 = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[112.43495757664542, 29.48694334539681],
         [112.43221099461417, 29.484851363774993],
         [112.44972045506339, 29.467815048751604],
         [112.37865264500479, 29.484851363774993],
         [112.41882140721182, 29.447188311051786],
         [112.41641814793448, 29.489931815646866],
         [112.4613934286962, 29.47588523909152],
         [112.49091918553214, 29.364938658633708],
         [112.4888592490087, 29.37840224553284],
         [112.38380248631339, 29.49979314201186],
         [112.54070098484854, 29.496207316234447],
         [112.44628722752432, 29.506665619863256],
         [112.31754119480948, 29.50576923616182],
         [112.36697967137198, 29.498000244992987],
         [112.33917052830557, 29.579843485671013],
         [112.50290267113621, 29.50462877323399],
         [112.37326219773612, 29.57449417828673],
         [112.35815599656425, 29.618676246502094],
         [112.33721330857597, 29.57329979980178],
         [112.22220018601737, 29.548214588417814],
         [112.3456356256879, 29.64330584314248],
         [112.2412655085004, 29.654942346769122],
         [112.25534174141056, 29.685071652898245],
         [112.11784521148977, 29.535950687661963],
         [112.10514226959523, 29.559844405838714],
         [112.29890688426435, 29.63626632270781],
         [112.32465609080732, 29.543732348544463],
         [112.43005617625654, 29.52043232892882],
         [112.21703214923225, 29.487434998781882],
         [112.42199583331428, 29.50133828101892],
         [112.19943223779661, 29.39532488304947],
         [112.24097429101927, 29.454832590118077],
         [112.24646745508177, 29.43958519383475],
         [112.24200425928099, 29.486814778689705],
         [112.2426909047888, 29.48173417052802],
         [112.06416307275755, 29.609269872109646],
         [112.15205369775755, 29.60329989631026],
         [112.27358995264036, 29.651348168449427],
         [112.25264726465208, 29.68147855109484],
         [112.3496359426306, 29.61800691304221],
         [112.3704913866356, 29.430105771014784],
         [112.43400609610826, 29.517381741199717],
         [112.22354924796373, 29.359445299513165],
         [112.23487889884264, 29.364232814884723],
         [112.23590886710436, 29.3534605888309],
         [112.24037206290514, 29.35136585702688],
         [112.22045934317858, 29.33730011392698],
         [112.20157659171373, 29.322334426672782],
         [112.20294988272936, 29.31754494292698],
         [112.20981633780748, 29.333109942890992],
         [112.20844304679186, 29.35046810164101],
         [112.1390918505028, 29.257357906439477],
         [112.11677587149889, 29.266043796970735],
         [112.14389836905748, 29.22650205728118],
         [112.1342853319481, 29.230097392233343],
         [112.1229556810692, 29.237587267915206],
         [112.1833804857567, 29.254063065320857],
         [112.15866124747545, 29.263348254725454],
         [112.15831792472154, 29.273231562187554],
         [112.1727374803856, 29.29329473152845],
         [112.04124486563951, 29.237287683409015],
         [112.00965917228014, 29.268439774863193],
         [112.02476537345201, 29.273231562187554],
         [112.08107030509264, 29.31993971290698],
         [112.13085210440904, 29.337599405268264],
         [112.11574590323717, 29.28910275311293],
         [112.13600194571764, 29.281017737478965],
         [112.20329320548326, 29.36902010518776],
         [112.08244359610826, 29.34777478802253],
         [112.00588262198717, 29.294836657537086],
         [112.03746831534654, 29.32447457464223],
         [112.02201879142076, 29.33884137507203],
         [112.00965917228014, 29.23553501652661],
         [112.17154025837291, 29.32774946215252],
         [112.34234400593901, 29.481416981953917],
         [112.22527094685698, 29.51817104415128],
         [112.44084772959688, 29.51789830930729],
         [112.46694025889376, 29.4993734888147],
         [112.50865397349337, 29.507441166024424],
         [112.37956461802462, 29.515806967081623],
         [112.42265162363985, 29.525872819585132],
         [112.37681803599337, 29.504660301907716],
         [112.43192908355596, 29.53378004265778],
         [112.37201926299932, 29.541695632349057],
         [112.42695090362432, 29.56499075230612],
         [112.3299622256458, 29.543637097444233],
         [112.53372428008916, 29.54274104126413],
         [112.4779343325794, 29.492997474887133],
         [112.427622892513, 29.555985586816764],
         [112.41457662786456, 29.559270656762976],
         [112.30317887503269, 29.51486120500027],
         [112.28927430349948, 29.503357942823058],
         [112.31210526663425, 29.51187347036238],
         [112.37767753653175, 29.59066687795449],
         [112.36342964224464, 29.600219866072766],
         [112.35278663687355, 29.596189809532344],
         [112.34798011831886, 29.542141653989432],
         [112.32888684706066, 29.66658419601684],
         [112.27083003973196, 29.648546019989496],
         [112.33400142645071, 29.65540837889815],
         [112.2992196927661, 29.483943908743672],
         [112.3761239896411, 29.481851865198877],
         [112.2988763700122, 29.463619372291262],
         [112.1890130887622, 29.513825528704682],
         [112.15502413612548, 29.52039830171181],
         [112.22145708900634, 29.53175026767451],
         [112.11004885536376, 29.503218563055505],
         [112.12361010414305, 29.50067870215768],
         [112.10901888710204, 29.519053905599097],
         [112.20961245399657, 29.507102932967054],
         [112.21562060218993, 29.49888582081655],
         [112.30024966102782, 29.479311468549415],
         [112.2857342944139, 29.354897938603145],
         [112.30925190305648, 29.34966110222312],
         [112.3132001147264, 29.330955918105342],
         [112.2579251513475, 29.363276316875847],
         [112.30135547971663, 29.383770514894834],
         [112.2860776171678, 29.396782936159198],
         [112.27663624143538, 29.325568188507674],
         [112.30461704587874, 29.317037034573058],
         [112.30290043210921, 29.308205790525758],
         [112.13879215574202, 29.306259820447284],
         [112.14411365842757, 29.307307655099606],
         [112.2198163256639, 29.327064808613688],
         [112.23972904539046, 29.300122287195244],
         [112.17192280149398, 29.306559202874165],
         [112.33894932126937, 29.312696349106112],
         [112.37036335325179, 29.34277799363683],
         [112.21260654783187, 29.326915147591347],
         [112.2802411303514, 29.30401442425707],
         [112.0015966261596, 29.31066089486608],
         [112.00640314471428, 29.31066089486608],
         [112.09910028826897, 29.286109606514827],
         [112.14029901873772, 29.298984798760902],
         [112.37328257978757, 29.234346153851288],
         [112.37808909834226, 29.238839958512724],
         [112.38289561689695, 29.236143699389018],
         [112.3530265373071, 29.274783291900693],
         [112.29157176435788, 29.292450797767614],
         [112.45293345869382, 29.24632919452486],
         [112.45465007246335, 29.317898611549488],
         [112.33448710859616, 29.214571070059854],
         [112.23458018720945, 29.27568171337659],
         [112.23114695967038, 29.193893037144875],
         [112.32830729902585, 29.20558113353553],
         [112.32693400801023, 29.245430515141653],
         [112.41482463301023, 29.212773145848956],
         [112.51095500410398, 29.281072076375473],
         [112.43782725752195, 29.2906542418119],
         [112.42855754316648, 29.19629070401176],
         [112.46357646406491, 29.239738695771244],
         [112.3035880607446, 29.27418433986259],
         [112.34581675947507, 29.30203189577923],
         [112.35130992353757, 29.302630684554426],
         [112.44881358564695, 29.319395344185946],
         [112.06220518684636, 29.210205065743246],
         [112.06701170540104, 29.21410062595911],
         [112.06186186409245, 29.237770460576733],
         [112.06735502815495, 29.237620668701307],
         [112.15181242561589, 29.20406176604992],
         [112.09396254158268, 29.223239628162958],
         [112.09344755745182, 29.21904477756188],
         [112.04194914436589, 29.22443812535152],
         [112.04675566292057, 29.24720690678757],
         [112.05156218147526, 29.246907350439695],
         [112.55255092770035, 29.27477663780479],
         [112.62173046261246, 29.27552532296523],
         [112.47307171017106, 29.252762843595125],
         [112.60113109737809, 29.291845296309305],
         [112.4968791415913, 29.29404788413205],
         [112.6348948886616, 29.300784582139933],
         [112.64364961888622, 29.299886381418645],
         [112.51138204699994, 29.357577267249106],
         [112.35826009875775, 29.29112606049775],
         [112.25148672229291, 29.326751685502646],
         [112.33491415149213, 29.406639527652008],
         [112.28547567492963, 29.374931257932058],
         [112.47430318957807, 29.37164021112186],
         [112.11872711422212, 29.59685056790402],
         [112.13177337887056, 29.603119434098957],
         [112.13829651119478, 29.55086698085676],
         [112.17846527340181, 29.55415221721822],
         [112.28077545406587, 29.567292094530558],
         [112.25845947506197, 29.58102741130738],
         [112.17331543209322, 29.527269873305343],
         [112.05236644226264, 29.67807169495834],
         [112.1110746331806, 29.63570615710989],
         [112.04584330993842, 29.702229960856247],
         [112.23913402038764, 29.71684140062067],
         [112.2587034173603, 29.67986139528992],
         [112.31500834900092, 29.667631141428945],
         [112.24497050720404, 29.735028180637432],
         [112.2886039446328, 29.527393773242782],
         [112.25083844170311, 29.56502700687404],
         [112.35726849541405, 29.571596451894653],
         [112.39503399834373, 29.522016453420466],
         [112.13273541435936, 29.57667254851206],
         [112.11900250420311, 29.489447690190698],
         [112.2995902727578, 29.475401046527654],
         [112.26457135185936, 29.54710816688638],
         [112.27967755303123, 29.555769336333256],
         [112.26422802910545, 29.52380892511849],
         [112.30110551204947, 29.43371916537528],
         [112.29715730037955, 29.437905195097425],
         [112.31260682430533, 29.443436469657016],
         [112.30333710994987, 29.425795136647636],
         [112.302822125819, 29.422356214843955],
         [112.36359025326041, 29.423103816443586],
         [112.36221696224479, 29.434317180187275],
         [112.44221116390494, 29.440596123069167],
         [112.42573167171744, 29.445678792401164],
         [112.43191148128776, 29.445678792401164],
         [112.43053819027213, 29.436260704002745],
         [112.43088151302604, 29.432523125185792],
         [112.30453873958854, 29.41413223416188],
         [112.26059342708854, 29.410991993223796],
         [112.30385209408072, 29.410543379454946],
         [112.33475114193229, 29.40306619180998],
         [112.33475114193229, 29.399626500819707],
         [112.31071854915885, 29.451508599688935],
         [112.43872207458547, 29.24547278461668],
         [112.45829147155813, 29.25655594078065],
         [112.44610351379445, 29.24008054480599],
         [112.39460510070852, 29.271830755193573],
         [112.35821288879445, 29.275125023824184],
         [112.3576979046636, 29.280814874091842],
         [112.33984512146047, 29.257005232596306],
         [112.34653991516164, 29.262246824611587],
         [112.34585326965383, 29.267637896111466],
         [112.35186141784719, 29.26823688650912],
         [112.36113113220266, 29.241428631394314],
         [112.36542266662649, 29.24652124269665],
         [112.36834091003469, 29.251164285056127],
         [112.38464874084524, 29.277371055195594],
         [112.38550704773, 29.272429721023652],
         [112.38121551330617, 29.271830755193573],
         [112.41159957702688, 29.28620496631059],
         [112.41657775695852, 29.286055245366597],
         [112.42275756652883, 29.285606081218045],
         [112.46635955627492, 29.248019021318026],
         [112.47700256164602, 29.248318574411307],
         [112.46876281555227, 29.24397496872439],
         [112.45022338684133, 29.23588638409234],
         [112.35065978820852, 29.22944501697468],
         [112.34568160827688, 29.23004423101143],
         [112.49228042419485, 29.29189419957914],
         [112.31615585144094, 29.23498761300974],
         [112.32044738586477, 29.239032020739128],
         [112.31581252868703, 29.265541402082835],
         [112.31203597839406, 29.275424497525655],
         [112.32456725891164, 29.282012696937063],
         [112.31821578796438, 29.285456359396328],
         [112.3170141583257, 29.290696492592847],
         [112.3221639996343, 29.290995920656133],
         [112.39563506897024, 29.288151318614254],
         [112.41674941833547, 29.295487236265572],
         [112.27770370300344, 29.246671021545385],
         [112.27495712097219, 29.236185972699666],
         [112.23564666564992, 29.265691153082],
         [112.29229492004445, 29.276921852870213]]),
    NonCrop1 = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[112.56127367120808, 29.526092021806427],
         [112.55578050714558, 29.52818315145647],
         [112.56625185113973, 29.530722322201107],
         [112.54942903619832, 29.532514639642635],
         [112.49672899347371, 29.532365281068984],
         [112.54084596735066, 29.547001372795147],
         [112.49535570245808, 29.549390737584144],
         [112.56058702570027, 29.523702106418767],
         [112.62032518487996, 29.530124875995778],
         [112.64367113214558, 29.490536205622256],
         [112.642126179753, 29.505477145345065],
         [112.64401445489949, 29.503086743113155],
         [112.65448579889363, 29.465729380471696],
         [112.65593440965694, 29.46328009556406],
         [112.46699113863474, 29.486741288451846],
         [112.46905107515818, 29.486442435982802],
         [112.47317094820505, 29.485994155626532],
         [112.47576134264696, 29.580965736186723],
         [112.61628955013667, 29.58650135318668],
         [112.63551562435542, 29.546486741905436],
         [112.57423251278315, 29.542902570567687],
         [112.406347686123, 29.550966777359495],
         [112.51140444881831, 29.58665063174531],
         [112.5411018670312, 29.581724322719523],
         [112.5370596444983, 29.622023420744053],
         [112.4440191781897, 29.6068012097236],
         [112.4158667123694, 29.60486095885548],
         [112.55044923190064, 29.59650252834278],
         [112.3519483951579, 29.66785061850011],
         [112.46129669227705, 29.68037912530875],
         [112.46575988807783, 29.68216878456331],
         [112.39486373939619, 29.63323996896664],
         [112.30147995033369, 29.620705592840157],
         [112.72299894939997, 29.393221077380645],
         [112.763167711607, 29.43867828609717],
         [112.7027429069195, 29.426119774843958],
         [112.44937071453668, 29.455121606641566],
         [112.38036284100153, 29.463790648277165],
         [112.68798002850153, 29.518776952639346],
         [112.54309782635309, 29.513996719837635],
         [112.73501524578668, 29.457214201764515],
         [112.686263414732, 29.450039410221965],
         [112.71063933025934, 29.47574673124351],
         [112.70136961590387, 29.476344498382456],
         [112.63304838787653, 29.539389119723985],
         [112.53841654392376, 29.531556010724337],
         [112.75402323337688, 29.48404842045139],
         [112.1645025564319, 29.41736527661746],
         [112.16621917020143, 29.48821691935451],
         [112.18750518094362, 29.387455233700486],
         [112.06940215359987, 29.392241431807356],
         [112.10030120145143, 29.447864452919255],
         [112.11609404813112, 29.482239789548114],
         [112.13532012234987, 29.486722669956553],
         [112.13943999539674, 29.4998713082979],
         [111.8953375173694, 29.45503939825214],
         [111.90022986661256, 29.452872020330823],
         [111.91593688260377, 29.442781893036607],
         [111.8737081838733, 29.454889925399147],
         [111.87430899869264, 29.46146652259678],
         [111.88538115750612, 29.463035874821657],
         [111.95601981412233, 29.451078293245274],
         [111.95910971890748, 29.445098973961773],
         [111.93507712613405, 29.45780460630997],
         [111.97876494656862, 29.44734125997724],
         [111.95164244901002, 29.461391790932783],
         [111.95310157071413, 29.45907508203857],
         [111.94580596219362, 29.45638464401907],
         [112.09820968535152, 29.431991550182588],
         [112.07160217192379, 29.38578347929824],
         [112.1026728811523, 29.430047944655968],
         [111.8939326467773, 29.38877492866135],
         [111.88380462553707, 29.39475756349267],
         [111.89255935576168, 29.3986460874311],
         [111.90509063627925, 29.430197454094017],
         [111.81562157193099, 29.307961030126886],
         [111.81098671475326, 29.315744558083814],
         [111.8130466512767, 29.313200008491282],
         [111.81733818570052, 29.30601505538201],
         [111.77734108487044, 29.27816858555199],
         [111.77991600552474, 29.28370854197348],
         [111.7833492330638, 29.28745158572549],
         [111.80600853482161, 29.288799047903247],
         [111.76498146572982, 29.304667820364376],
         [111.78180428067122, 29.27861778239723],
         [111.81287498989974, 29.305865363480347],
         [111.85081215420638, 29.27741991975543],
         [111.85287209072982, 29.27622204307281],
         [111.90471382656966, 29.27622204307281],
         [111.8492672018138, 29.326371108649997],
         [111.85098381558333, 29.32337782611809],
         [111.90591545620833, 29.316193589660276],
         [111.88909264126693, 29.323976489651947],
         [111.74575539151107, 29.265440521151106],
         [111.7503902486888, 29.27412572509356],
         [111.7474720052806, 29.273975986449724],
         [111.82248802700911, 29.297182857606202],
         [111.8822261861888, 29.330411900720087],
         [111.89973564663802, 29.266788273577276],
         [111.9122669271556, 29.27412572509356],
         [112.24538870771359, 29.344416706670383],
         [112.24435873945187, 29.339478617442076],
         [112.24401541669796, 29.3339416874618],
         [112.24470206220577, 29.32675819507776],
         [112.24659033735226, 29.32077156489224],
         [112.2486502738757, 29.3162813616804],
         [112.25071021039913, 29.3123896923827],
         [112.25225516279171, 29.309096625514776],
         [112.25586005170773, 29.305953144383786],
         [112.26049490888546, 29.301462289121492],
         [112.2651297660632, 29.299216787407747],
         [112.32915945966671, 29.3336423853826],
         [112.33036108930538, 29.32660853360551],
         [112.33224936445187, 29.32151991288055],
         [112.33636923749874, 29.32196891903838],
         [112.34804221113156, 29.319574196692272],
         [112.33156271894406, 29.31074317223113],
         [112.33190604169796, 29.30340835065773],
         [112.33156271894406, 29.299815592693633],
         [111.82876654584835, 29.32421392018177],
         [111.8370062919421, 29.32750649914477],
         [111.82979651411007, 29.3658123282858],
         [111.88764639814327, 29.345464149385727],
         [111.89056464155148, 29.343518890060288],
         [111.87116690595577, 29.330350004524803],
         [111.83219977338742, 29.359079924929347],
         [111.82190009077023, 29.31747876852647],
         [111.85142584760617, 29.310144431044208],
         [111.74808569868038, 29.442231268793098],
         [111.76971503217648, 29.438344412545415],
         [111.77795477827023, 29.438045417439255],
         [111.79649420698117, 29.447014887561036],
         [111.79340430219601, 29.44133431517565],
         [111.7930609794421, 29.436550428700425],
         [111.75323553998898, 29.41860884702066],
         [111.76284857709835, 29.40604785441545],
         [111.9878966422839, 29.49693044645179],
         [111.99356146772335, 29.492746852457294],
         [111.94875784833859, 29.481838812827505],
         [111.95064612348507, 29.47825235152926],
         [111.95304938276242, 29.473918541476504],
         [111.95734091718624, 29.469733997347763],
         [111.96506567914913, 29.46270955288958],
         [111.96798392255734, 29.45717932880838],
         [111.97158881147335, 29.452396189175584],
         [112.59071982945774, 29.406996846873607],
         [112.5773302420554, 29.393237916666525],
         [112.60977424229954, 29.336986422734288],
         [112.6380983694968, 29.36631288725891],
         [112.64565147008274, 29.359580516994708],
         [112.65646613683079, 29.368856111303625],
         [112.56823218907688, 29.385161155856345],
         [112.56153739537571, 29.318727933392715],
         [111.89180053319309, 29.29343003674063],
         [111.89592040623997, 29.28354868267247],
         [111.8320623740134, 29.261087505558514],
         [111.94810546483372, 29.255396557215573],
         [111.94759048070286, 29.267526880961004],
         [111.94810546483372, 29.276211907646687],
         [111.95188201512669, 29.286243692214814],
         [111.88562072362278, 29.24940574319215],
         [111.82862914647434, 29.25270073432074],
         [111.84545196141575, 29.287740889018497],
         [111.86193145360325, 29.257942546934665],
         [111.9225279196677, 29.299118867558356],
         [111.92458785619114, 29.29866976085859],
         [111.83961547459934, 29.243564361754032],
         [111.82416595067356, 29.25584585412404],
         [111.87480605687473, 29.30226255914421],
         [111.80030501927708, 29.19712101250101],
         [111.8045965537009, 29.19667145787449],
         [111.8071714743552, 29.195922195783467],
         [111.75524390782688, 29.225963312427087],
         [111.75781882848118, 29.226337834344687],
         [111.79961837376926, 29.211955209275015]]),
    crops2 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[112.55916346142413, 29.69848725236603],
         [112.48191584179523, 29.713397418306354],
         [112.31128443310382, 29.66358881588889],
         [112.2385000092757, 29.65284839854989],
         [112.14305628368976, 29.591665846748832],
         [112.13172663281085, 29.602711298156567],
         [112.25154627392413, 29.63882446182923],
         [112.27351893017413, 29.650461483458745],
         [112.32963084757674, 29.54328335273552],
         [112.35984324992049, 29.613748452084884],
         [112.22251414835799, 29.54388072120013],
         [112.17994212687361, 29.555528700643443],
         [112.29323863566268, 29.50325162653088],
         [112.24380015910018, 29.498470660558187],
         [112.15522288859236, 29.520580735770437],
         [112.22217082560408, 29.475160219671825],
         [112.10554577645816, 29.6329380018935],
         [112.11172558602847, 29.58697086323905],
         [112.07704998788394, 29.657703803984674],
         [112.12030865487613, 29.530528018899258],
         [112.10655999925682, 29.559008338977577],
         [112.12269616869041, 29.500757026554695],
         [112.41732066846251, 29.488789958464064],
         [112.36341899609923, 29.426909962190454],
         [112.22075429012276, 29.6047728415706],
         [112.06248250057197, 29.60865330936312],
         [112.16513600398994, 29.548041277813574],
         [112.33679738094307, 29.572529336662928],
         [112.21045460750557, 29.503230693464676],
         [112.21451121177975, 29.325607406354223],
         [112.02911692467038, 29.250748443704545],
         [112.22000437584225, 29.302856086018643],
         [112.08576517906491, 29.32231476608415],
         [112.085421856311, 29.28249534261012],
         [112.19116526451413, 29.252845241000287],
         [112.17041534240774, 29.26299560153993],
         [112.20268768127492, 29.27377738130844],
         [112.07651656921438, 29.232590851545986],
         [112.10947555358938, 29.276622383556358],
         [112.10329574401906, 29.28156351501565],
         [112.26036590393117, 29.22869599449759],
         [112.29761642273, 29.267937391748966],
         [112.32233566101125, 29.276472648570373],
         [112.30980438049367, 29.258952140990974],
         [112.2698072796636, 29.196482846025688],
         [112.27461379821828, 29.195284021846764],
         [112.28560012634328, 29.210118484451176],
         [112.29246658142141, 29.211466965501835],
         [112.31426757629445, 29.22255380352593],
         [112.09351104553274, 29.195583729205524],
         [112.26379913147024, 29.1934857592982],
         [112.25401443298391, 29.229295212917577],
         [112.28354018981985, 29.25221268481455],
         [112.38481656161628, 29.195727668183743],
         [112.39949360934577, 29.20074762916592],
         [112.33503476229987, 29.20614194009708],
         [112.31160298434577, 29.201047320553787],
         [112.30353489962897, 29.19587752132426],
         [112.3294557675489, 29.19797544229557],
         [112.39520207492194, 29.20704096431908],
         [112.27315083590827, 29.206666371851586],
         [112.43399754611335, 29.21400813464065],
         [112.6154436215528, 29.211610882178054],
         [112.61389866916022, 29.201272088519758],
         [112.4525444257689, 29.313515664355574],
         [112.48138353709703, 29.30468411556966],
         [112.4909965742064, 29.302139290207798],
         [112.45082781199937, 29.307677946539062],
         [112.4606125104857, 29.32084975952476],
         [112.3892013776732, 29.288366193628416],
         [112.38387987498766, 29.288366193628416],
         [112.33959123973375, 29.302288987573398],
         [112.48739168529039, 29.279532469382765],
         [112.26042560314394, 29.329601721322355],
         [112.28651813244082, 29.345164881136995],
         [112.26162723278262, 29.32077156489224]]),
    NonCrop2 = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[112.15442972984616, 29.30375426061314],
         [112.18223887291256, 29.27261293089549],
         [111.84166270103756, 29.239964235958965],
         [111.80561381187741, 29.262430052732352],
         [111.84646921959225, 29.23247453418884],
         [111.82998972740475, 29.288783652451794],
         [111.83101969566647, 29.280099694193915],
         [111.82346659508053, 29.28369314575488],
         [111.79806071129147, 29.260333451920797],
         [112.12215739097897, 29.32081807627984],
         [112.14687662926022, 29.332491674344013],
         [112.23511057701413, 29.334886093399803],
         [112.09022837486569, 29.235770070479496],
         [111.82827311363522, 29.347156608418615],
         [112.1622179548143, 29.411703680951103],
         [112.20993981760726, 29.41858212927295],
         [112.12754395822809, 29.45118063284528],
         [112.18907464135842, 29.380110405120767],
         [112.16538537133889, 29.48596002682813],
         [112.38133538354592, 29.462347784491286],
         [112.36176598657326, 29.444709738333653],
         [112.19491112817482, 29.460554224941554],
         [112.23027337182717, 29.414508679722335],
         [111.97896111596779, 29.46324455237279],
         [112.07680810083107, 29.540635604862455],
         [112.24984276879982, 29.5621392087236],
         [112.48261559594826, 29.344503424042085],
         [112.68517602075295, 29.449792201676015],
         [112.71950829614357, 29.39237547239955],
         [112.43592370141701, 29.398956118406275],
         [112.63985741723732, 29.486258880720005],
         [112.83486474145607, 29.51494474953817],
         [112.51900780786232, 29.54541457890607],
         [112.27524865258889, 29.614684302424937],
         [112.05140221704201, 29.359465856944333],
         [111.75653136815403, 29.225888407879232],
         [111.86875028083556, 29.268275619222763],
         [111.86986607978575, 29.267676629052044],
         [111.8561331696295, 29.273965850800835],
         [111.88385648200743, 29.271944357437874],
         [111.88660306403868, 29.270971031560013],
         [111.8763033814215, 29.25779278458789],
         [111.89449948737852, 29.269024352000887],
         [111.87793416450255, 29.255097024846865],
         [111.8769900269293, 29.250978365832502],
         [111.85879392097227, 29.257493259236426],
         [111.85364407966368, 29.255995619321602],
         [111.8480650849127, 29.25854159412883],
         [111.85879392097227, 29.27426532789883],
         [111.86325711677306, 29.27883224491314],
         [111.84870881507628, 29.28317437016895],
         [111.82536286781065, 29.28781574828266],
         [111.82789487312071, 29.28253803576574],
         [111.85845059821837, 29.284110148856474],
         [111.8466059632086, 29.289799498793595],
         [111.84724969337218, 29.291259215130303],
         [111.83055562446349, 29.286243692214814],
         [111.94801492164366, 29.272767933634054],
         [111.94784326026671, 29.27138282440866],
         [111.947714514234, 29.274920430991468],
         [111.94672746131651, 29.275706549159942],
         [111.94767159888976, 29.268874605883976],
         [111.93902415702574, 29.280273401770362],
         [111.98431211562952, 29.26768131743506],
         [111.97109418960413, 29.271949045625167],
         [111.97658735366663, 29.27531817886429],
         [112.00662809463343, 29.256824012869313],
         [111.99358182998499, 29.2774144723847],
         [111.96654516311487, 29.249035994905025],
         [111.96714597793421, 29.261990736045334]]),
    Elevations = ee.Image("USGS/SRTMGL1_003"),
    FLDAS = ee.ImageCollection("NASA/FLDAS/NOAH01/C/GL/M/V001"),
    CHIRPS = ee.ImageCollection("UCSB-CHG/CHIRPS/DAILY");
/*-----------------------------------------------------------------------------------------------------*/
NdviEvi = NdviEvi.filterDate("2000-01-01", "2019-12-31").filterBounds(Hunan);
Ndwi = Ndwi.filterDate("2010-01-01", "2019-12-31").filterBounds(Hunan);
CHIRPS = CHIRPS.filterDate("2000-01-01", "2019-12-31").filterBounds(Hunan);
FLDAS = FLDAS.filterDate("2000-01-01", "2019-12-31").filterBounds(Hunan);
print("FLDAS dataset: ",FLDAS);

//************************************************************************//
//*****************CALCULATE MONTHLY PRECIPITATIONS***********************//

// set start and end year
var startyear = 2000;
var endyear = 2019;
 
// make a date object
var startdate = ee.Date.fromYMD(startyear, 1, 1);
var enddate = ee.Date.fromYMD(endyear + 1, 1, 1);
 
// make a list with years
var years = ee.List.sequence(startyear, endyear);
// make a list with months
var months = ee.List.sequence(1, 12);

var monthlyPrecip =  ee.ImageCollection.fromImages(
  years.map(function (y) {
    return months.map(function(m) {
      var w = CHIRPS.filter(ee.Filter.calendarRange(y, y, 'year'))
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .sum();
      return w.set('year', y)
              .set('month', m)
              .set('system:time_start', ee.Date.fromYMD(y, m, 1));
 
    });
  }).flatten()
);

print("Monthly P. Dataset: ", monthlyPrecip);
//***********************************************************************//
//******************CALCULATE MEAN MONTHLY PRECIPITATION******************//

var meanMonthlyP =  ee.ImageCollection.fromImages(
  months.map(function (m) {
    var w = monthlyPrecip.filter(ee.Filter.eq('month', m)).mean();
    return w.set('month', m)
            .set('system:time_start',ee.Date.fromYMD(1, m, 1));
  }).flatten()
);

print("Mean Monthly P. Dataset: ", meanMonthlyP);



//***********************************************************************//
//******************CALCULATE MEAN MONTHLY TEMPERATURE******************//


var FLDASconvertTemp = function(image){
  var Temperat = image.expression(
    'K-273',
    {'K':image.select('Tair_f_tavg')
    }).set('system:time_start', image.get('system:time_start')).
    rename('Tair_in_C');
    return image.addBands(Temperat);
};

FLDAS = FLDAS.map(FLDASconvertTemp);

print("New FLDAS: ", FLDAS);

var meanMonthlyT = ee.ImageCollection.fromImages(
    months.map(function(m) {
      var w = FLDAS.select('Tair_in_C')
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .mean();
      return w.set('month', m)
              .set('system:time_start', ee.Date.fromYMD(1, m, 1));
 
    }).flatten()
);

print("Mean Monthly T. Dataset: ", meanMonthlyT);


//***********************************************************************//
//******************CALCULATE MEAN SOIL MOISTURE******************//

var meanMonthlySM = ee.ImageCollection.fromImages(
    months.map(function(m) {
      var w = FLDAS.select('SoilMoi00_10cm_tavg')
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .mean();
      return w.set('month', m)
              .set('system:time_start', ee.Date.fromYMD(1, m, 1));
 
    }).flatten()
);

print("Mean Monthly SM. Dataset: ", meanMonthlySM);


//***********************************************************************//
//******************CALCULATE RAINFALL ANOMALIES******************//



//***********************************************************************//
//*************************GRÁFICOS*************************************//
/*-----------------------------------------------------------------------*/


//Monthly Prec.

var title = {
  title: 'Monthly precipitation',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Precipitation (mm)'},
};

var chartMonthly = ui.Chart.image.seriesByRegion({
  imageCollection: monthlyPrecip,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'precipitation',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title)
  .setChartType('ColumnChart');
 
print(chartMonthly);

//Mean monthly prec.
var title2 = {
  title: 'Mean monthly precipitation',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Precipitation (mm)'},
};

var chartMeanMonthly = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlyP,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'precipitation',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title2)
  .setChartType('ColumnChart');
 
print(chartMeanMonthly);


//Monthly Temp.
var title3 = {
  title: 'Monthly temperature',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Temperature (°C)'},
};


var chartMonthlyT = ui.Chart.image.seriesByRegion({
  imageCollection: FLDAS,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'Tair_in_C',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title3)
  .setChartType('ColumnChart');
 
print(chartMonthlyT);

//Mean monthly temp.
var title4 = {
  title: 'Mean monthly temperature',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Temperature (°C)'},
};

var chartMeanMonthlyT = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlyT,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'Tair_in_C',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title4)
  .setChartType('ColumnChart');
 
print(chartMeanMonthlyT);

//Monthly SM.
var title5 = {
  title: 'Monthly soil moisture',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Soil moisture'},
};


var chartMonthlySM = ui.Chart.image.seriesByRegion({
  imageCollection: FLDAS,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'SoilMoi00_10cm_tavg',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title5)
  .setChartType('ColumnChart');
 
print(chartMonthlySM);

//Mean monthly soil moisture.
var title6 = {
  title: 'Mean monthly soil moisture',
  hAxis: {title: 'Time'},
  vAxis: {title: 'Soil moisture'},
};

var chartMeanMonthlySM = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlySM,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'SoilMoi00_10cm_tavg',
  scale: 2500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title6)
  .setChartType('ColumnChart');
 
print(chartMeanMonthlySM);

//***********************************************************************//
//*************************Monthly SVI  function*************************//
//-----------------------------------------------------------------------//

var SVIconvert_NDVI = function(image){
  var SVI = image.expression(
    'NDVI/10000',
    {'NDVI':image.select('NDVI')
    }).set('system:time_start', image.get('system:time_start')).
    rename('ndvi_d');
    return image.addBands(SVI);
};

var SVIconvert_EVI = function(image){
  var SVI = image.expression(
    'EVI/10000',
    {'EVI':image.select('EVI')
    }).set('system:time_start', image.get('system:time_start')).
    rename('evi_d');
    return image.addBands(SVI);
};


NdviEvi = NdviEvi.map(SVIconvert_NDVI);
NdviEvi = NdviEvi.map(SVIconvert_EVI);

//Monthly NDVI

var title7 = {
  title: 'Monthly NDVI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'NDVI'},
};


var chartMonthlyNDVI = ui.Chart.image.seriesByRegion({
  imageCollection: NdviEvi,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'ndvi_d',
  scale: 250,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title7)
  .setChartType('ColumnChart');
 
print(chartMonthlyNDVI);

//Monthly EVI

var title8 = {
  title: 'Monthly EVI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'EVI'},
};


var chartMonthlyEVI = ui.Chart.image.seriesByRegion({
  imageCollection: NdviEvi,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'evi_d',
  scale: 250,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title8)
  .setChartType('ColumnChart');
 
print(chartMonthlyEVI);

//Monthly NDWI

var title9 = {
  title: 'Monthly NDWI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'NDWI'},
};


var chartMonthlyNDWI = ui.Chart.image.seriesByRegion({
  imageCollection: Ndwi,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'NDWI',
  scale: 500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title9)
  .setChartType('ColumnChart');
 
print(chartMonthlyNDWI);

//***********************************************************************//
//***************************CALCULATE MEAN SVI***************************//
//-----------------------------------------------------------------------//
var meanMonthlySVI_NDVI = ee.ImageCollection.fromImages(
    months.map(function(m) {
      var w = NdviEvi.select('ndvi_d')
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .mean();
      return w.set('month', m)
              .set('system:time_start', ee.Date.fromYMD(1, m, 1));
 
    }).flatten()
);

print("Mean Monthly SVI-NDVI Dataset: ", meanMonthlySVI_NDVI);

var meanMonthlySVI_EVI = ee.ImageCollection.fromImages(
    months.map(function(m) {
      var w = NdviEvi.select('evi_d')
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .mean();
      return w.set('month', m)
              .set('system:time_start', ee.Date.fromYMD(1, m, 1));
 
    }).flatten()
);

print("Mean Monthly SVI-EVI Dataset: ", meanMonthlySVI_EVI);

var meanMonthlySVI_NDWI = ee.ImageCollection.fromImages(
    months.map(function(m) {
      var w = Ndwi.select('NDWI')
                    .filter(ee.Filter.calendarRange(m, m, 'month'))
                    .mean();
      return w.set('month', m)
              .set('system:time_start', ee.Date.fromYMD(1, m, 1));
 
    }).flatten()
);

print("Mean Monthly SVI-NDWI Dataset: ", meanMonthlySVI_EVI);

//Mean Monthly NDVI

var title10 = {
  title: 'Mean monthly NDVI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'NDVI'},
};

var chartMeanMonthlyNDVI = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlySVI_NDVI,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'ndvi_d',
  scale: 250,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title10)
  .setChartType('ColumnChart');
 
print(chartMeanMonthlyNDVI);

//Mean Monthly EVI

var title11 = {
  title: 'Mean monthly EVI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'EVI'},
};

var chartMeanMonthlyEVI = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlySVI_EVI,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'evi_d',
  scale: 250,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title11)
  .setChartType('ColumnChart');
 
print(chartMeanMonthlyEVI);

//Mean Monthly NDWI

var title11 = {
  title: 'Mean monthly NDWI',
  hAxis: {title: 'Time'},
  vAxis: {title: 'NDWI'},
};

var chartMeanMonthlyNDWI = ui.Chart.image.seriesByRegion({
  imageCollection: meanMonthlySVI_NDWI,
  regions: Hunan,
  reducer: ee.Reducer.mean(),
  band: 'NDWI',
  scale: 500,
  xProperty: 'system:time_start',
  seriesProperty: 'SITE'
}).setOptions(title11)
  .setChartType('ColumnChart');
 
print(chartMeanMonthlyNDWI);

//***********************************************************************//
//*****************************CHARTS DOYs ******************************//
//-----------------------------------------------------------------------//

//DOY Rainfall

var DoyRainfall = ui.Chart.image.doySeries(
    monthlyPrecip, Hunan, ee.Reducer.mean(), 2500)
    .setOptions({
      title:'Doy precipitation',
      hAxis:{title:'DOY'},
      vAxis:{title:'Precipitation (mm)'}
    }).setSeriesNames(['precipitation']);
print(DoyRainfall);

var DoySoilM = ui.Chart.image.doySeries(
    FLDAS.select("SoilMoi00_10cm_tavg"), Hunan, ee.Reducer.mean(), 2500)
    .setOptions({
      title:'Doy soil moisture',
      hAxis:{title:'DOY'},
      vAxis:{title:'Soil moisture'}
    }).setSeriesNames(['SM']);
print(DoySoilM);

var DoyTair = ui.Chart.image.doySeries(
    FLDAS.select("Tair_in_C"), Hunan, ee.Reducer.mean(), 2500)
    .setOptions({
      title:'Doy Temperature',
      hAxis:{title:'DOY'},
      vAxis:{title:'Temperature (°C)'}
    }).setSeriesNames(['Temperature']);
print(DoyTair);

var DoyNDVI = ui.Chart.image.doySeries(
    NdviEvi.select("ndvi_d"), Hunan, ee.Reducer.mean(), 250)
    .setOptions({
      title:'Doy NDVI',
      hAxis:{title:'DOY'},
      vAxis:{title:'NDVI'}
    }).setSeriesNames(['NDVI']);
print(DoyNDVI);

var DoyEVI = ui.Chart.image.doySeries(
    NdviEvi.select("evi_d"), Hunan, ee.Reducer.mean(), 250)
    .setOptions({
      title:'Doy EVI',
      hAxis:{title:'DOY'},
      vAxis:{title:'EVI'}
    }).setSeriesNames(['EVI']);
print(DoyEVI);

var DoyNDWI = ui.Chart.image.doySeries(
    Ndwi.select("NDWI"), Hunan, ee.Reducer.mean(), 500)
    .setOptions({
      title:'Doy NDWI',
      hAxis:{title:'DOY'},
      vAxis:{title:'NDWI'}
    }).setSeriesNames(['NDWI']);
print(DoyNDWI);
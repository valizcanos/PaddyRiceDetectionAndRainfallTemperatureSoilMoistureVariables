var RioGrandeDoSul = 
    /* color: #98ff00 */
    /* shown: false */
    /* displayProperties: [
      {
        "type": "rectangle"
      }
    ] */
    ee.Geometry.Polygon(
        [[[-57.50935909674871, -30.139662860453758],
          [-57.50935909674871, -30.257167898511362],
          [-57.189382290108085, -30.257167898511362],
          [-57.189382290108085, -30.139662860453758]]], null, false),
    RioGrandeDoSul2 = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-57.078506285408906, -30.0674607121418],
          [-57.30509930298703, -29.94853984596945],
          [-57.317458922127656, -29.98661003056609],
          [-57.339431578377656, -30.018720399907025],
          [-57.37651043579953, -30.02942154684581],
          [-57.41770916626828, -30.05438639695123],
          [-57.42869549439328, -30.08172163185648],
          [-57.45616131470578, -30.12092855914528],
          [-57.490493590096406, -30.14943291612472],
          [-57.54679852173703, -30.17080578036826],
          [-57.58525067017453, -30.18979999191526],
          [-57.550918394783906, -30.20879054084404],
          [-57.54867299962717, -30.222951853154576],
          [-57.55862935949045, -30.248164380299627],
          [-57.553822840935766, -30.261213030368722],
          [-57.541119899041234, -30.272184417009733],
          [-57.5229237930842, -30.28107923578961],
          [-57.504384364373266, -30.282265150714984],
          [-57.4954579727717, -30.266550614847425],
          [-57.4679921524592, -30.261509570451437],
          [-57.455975856072484, -30.266254089988298],
          [-57.443959559685766, -30.271591400428647],
          [-57.42233022618967, -30.271591400428647],
          [-57.40962728429514, -30.27870736294036],
          [-57.41443380284983, -30.288194510335895],
          [-57.4072240250178, -30.2941235115829],
          [-57.39349111486155, -30.28700866708029],
          [-57.38834127355295, -30.27307393516398],
          [-57.37220510411936, -30.268033225709623],
          [-57.35950216222483, -30.265661037583413],
          [-57.35469564367014, -30.272777430008222],
          [-57.346112574822484, -30.27366694278847],
          [-57.32997640538889, -30.265957564233627],
          [-57.32173665929514, -30.25913722471717],
          [-57.315503913671634, -30.25265870528215],
          [-57.306234199316165, -30.25710709993457],
          [-57.297994453222415, -30.269561533127877],
          [-57.29044135263648, -30.28468264946737],
          [-57.28220160654273, -30.28586852083935],
          [-57.276021796972415, -30.27786361092024],
          [-57.27190192392554, -30.26541023091638],
          [-57.26160224130835, -30.26007258444735],
          [-57.2533624952146, -30.26748590396358],
          [-57.249585944921634, -30.278753077604676],
          [-57.240316230566165, -30.283496763761423],
          [-57.2310465162107, -30.28468264946737],
          [-57.21628363779273, -30.282014386472355],
          [-57.20255072763648, -30.263927580445156],
          [-57.18950446298804, -30.25265870528215],
          [-57.17371161630835, -30.24376131166263],
          [-57.167188483984134, -30.231006975905785],
          [-57.17027838876929, -30.214097515252195],
          [-57.173250752983726, -30.20341635822852],
          [-57.167757588921226, -30.190360036573434],
          [-57.15745790630404, -30.176114802199447],
          [-57.14715822368685, -30.157117952548017],
          [-57.1334253135306, -30.135445202480117],
          [-57.12165644674473, -30.125096159167406],
          [-57.11410334615879, -30.10727750849509],
          [-57.095563917447855, -30.103119360864195],
          [-57.08492091207676, -30.086187953668862],
          [-57.069814710904886, -30.080840591119546]]]),
    crops1 = 
    /* color: #d63000 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[-57.553543038641514, -30.19111088353638],
         [-57.374500222479405, -30.032220727478464],
         [-57.54667658356339, -30.253631499636803],
         [-57.55268473175675, -30.255262584914078],
         [-57.20781702545792, -30.230496829584006],
         [-57.353557534491124, -30.226047230293577],
         [-57.41132158783585, -30.103381650144186],
         [-57.201465554510655, -30.223525701322735],
         [-57.13872332123429, -30.124170583219378],
         [-57.28206057099015, -30.253334935767462],
         [-57.34308619049698, -30.226492199283125],
         [-57.41578478363663, -30.09907482422647],
         [-57.341026253973546, -30.220559113883155],
         [-57.34514612702042, -30.231386725279936],
         [-57.15631861237198, -30.03340963892518],
         [-57.18635935333878, -30.234352986095086],
         [-57.54890818146378, -30.199642133800417],
         [-57.45320696381241, -30.167738891609318],
         [-57.207988686834874, -30.23454952693855],
         [-57.206443734442296, -30.178472176352578],
         [-57.47567442785717, -30.250767565435897],
         [-57.46374396215893, -30.251360707780368],
         [-57.48322752844311, -30.25981259705606],
         [-57.21500662695385, -30.22696477465981],
         [-57.54159239660717, -30.25521604572736],
         [-57.40949896704174, -30.072514810741993],
         [-57.159216679444086, -30.042948076941784],
         [-57.470190835382475, -30.25478774251362],
         [-57.153561425592436, -30.08255828693448],
         [-57.20420153179361, -30.045045008322955],
         [-57.211239648248686, -30.22824204335479],
         [-57.403242898370756, -30.048982713153546],
         [-57.16595639724142, -30.028414315425078],
         [-57.21015920180685, -30.230331885258988],
         [-57.32663144606955, -30.238637279116286],
         [-57.33109464187033, -30.255468380195037],
         [-57.21917142409689, -30.172471298197845],
         [-57.20870008010275, -30.222322448137138],
         [-57.16720479475932, -30.04863845069821],
         [-57.19664472090678, -30.16988798001998],
         [-57.20076459395366, -30.180275989927793],
         [-57.21243756758647, -30.176269315839207],
         [-57.21260922896342, -30.222410392554472],
         [-57.07862752425151, -30.074044114802042],
         [-57.13621991621928, -30.119713328223725],
         [-57.34753507124858, -30.205454175514873],
         [-57.38282105470505, -30.23711447009582],
         [-57.25767991090622, -30.248978284983345],
         [-57.48461625123825, -30.146902701687623],
         [-57.18549630189743, -30.17836750416991],
         [-57.195489445484476, -30.05069857101943],
         [-57.084682026661234, -30.07194424769271],
         [-57.14639429167588, -30.111526292337214],
         [-57.143819371021586, -30.111600540190434],
         [-57.16871027067979, -30.11367945742544],
         [-57.092921772754984, -30.061990547301065],
         [-57.16347459868272, -30.07432110269105],
         [-57.1705127151378, -30.115906820200454],
         [-57.14270357207139, -30.10922458121093],
         [-57.18046907500108, -30.057459053628225],
         [-57.086141148365336, -30.066076142459366],
         [-57.36886743620713, -30.02967126389519],
         [-57.13291887358506, -30.113902195962986],
         [-57.13394884184678, -30.111674787987855],
         [-57.311757302658016, -30.15150505358683],
         [-57.19863245524591, -30.176439087427923],
         [-57.262833810226375, -30.151059745676665],
         [-57.334244943038875, -30.17436149215273],
         [-57.33690569438165, -30.18230063794705],
         [-57.33905146159356, -30.194987103468154],
         [-57.3330433134002, -30.18460064477838],
         [-57.36945653460811, -30.230536852438483],
         [-57.32963109515499, -30.24492250613932],
         [-57.350402121766315, -30.228460398671377],
         [-57.53854959859889, -30.23446430829274],
         [-57.54206865682643, -30.2490718203534],
         [-57.47245996847194, -30.261453137588923],
         [-57.320192932667254, -30.241073665066345],
         [-57.28139746147585, -30.248784996998797],
         [-57.264488815845965, -30.211409057766016],
         [-57.21625196892214, -30.240925364291147],
         [-57.262257217945574, -30.21541430218889],
         [-57.27942335564089, -30.244781111717668],
         [-57.305172562183856, -30.2366245444708],
         [-57.32474195915651, -30.228467300362265],
         [-57.19303877278306, -30.180548376574475],
         [-57.290113281450054, -30.155689596927175],
         [-57.2104503831559, -30.184632247344588],
         [-57.218861790626605, -30.20169513123947],
         [-57.20942041489418, -30.200656605426587],
         [-57.213368626564105, -30.201101689259414],
         [-57.179894658058245, -30.173947893459832],
         [-57.57196766753672, -30.19263956374087],
         [-57.575572556452734, -30.190933251476107],
         [-57.570766037898046, -30.195458623574904],
         [-57.57874829192637, -30.189152720200564],
         [-57.52054508160346, -30.17000260503365],
         [-57.55513484905951, -30.180761582527087],
         [-57.53736241384717, -30.17060711354934],
         [-57.52414448782178, -30.17164595623697],
         [-57.332913713896, -30.17817557381911],
         [-57.530495958769045, -30.168380985204685],
         [-57.31527277709179, -30.191004034645765],
         [-57.31939265013867, -30.148707752979345],
         [-57.188487553213946, -30.02204284015747],
         [-57.164283299063555, -30.02657595400988],
         [-57.19689896068465, -30.020259263138087],
         [-57.32375671825301, -29.997664511062613],
         [-57.30622121976065, -30.005354090911492],
         [-57.342355939609284, -30.025940684678304],
         [-57.442692014438386, -30.107279041367974],
         [-57.32596227811026, -30.00542841842967],
         [-57.42389509366202, -30.095101115139364],
         [-57.41943189786124, -30.08054504023313],
         [-57.280135564291506, -29.99293728037966],
         [-57.379784993612795, -30.03663771975035],
         [-57.32354792094249, -30.007126163163242],
         [-57.33899744486827, -30.024219720417943],
         [-57.410751900434676, -30.078156570379743],
         [-57.304407677412215, -29.98475144929696],
         [-57.22467096781749, -29.992631491983744],
         [-57.40139635539073, -30.090930692372723],
         [-57.40482958292979, -30.088628501576597],
         [-57.18021067118663, -30.02830687366568],
         [-57.18021067118663, -30.03261677999264],
         [-57.158986422595255, -30.037153284980327],
         [-57.184478137072794, -30.02392634153126],
         [-57.32062650056614, -30.00125962006426],
         [-57.30646443696751, -29.98906865082681],
         [-57.22339837765426, -30.16984397799738],
         [-57.18623368954391, -30.168063065555234],
         [-57.18528955197067, -30.165688465579304],
         [-57.21660952431601, -30.178913706718966],
         [-57.21248965126914, -30.16347948355204],
         [-57.28501658303183, -30.159694761814286],
         [-57.18996122888056, -30.236730883206434],
         [-57.33909476694769, -30.165883267264565],
         [-57.34252799448675, -30.17233906453691],
         [-57.29787652584003, -30.136831728302553],
         [-57.15095735726852, -30.087077868571118],
         [-57.18486047921676, -30.05565825690758],
         [-57.53199800725671, -30.17390760391068],
         [-57.52882227178308, -30.177840176065764],
         [-57.41239319412116, -30.101217890882907],
         [-57.41754303542975, -30.101589168320917],
         [-57.422202228691255, -30.088965662484327],
         [-57.30289757170883, -30.003449918290922],
         [-57.33834564604965, -30.019726627900297],
         [-57.16454181009436, -30.035181998336068],
         [-57.185227006017215, -30.050859153229702]]),
    crops2 = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[-57.541178674944305, -30.19439288152426],
         [-57.319992990740204, -30.14541826491468],
         [-57.316988916643524, -30.23444491437953],
         [-57.46525519706656, -30.257191555770035],
         [-57.46954673149039, -30.24925845142324],
         [-57.47658484794547, -30.257043279321465],
         [-57.21153968192984, -30.182654449111958],
         [-57.16098540641715, -30.033485308041215],
         [-57.20368943315455, -30.22812509495913],
         [-57.08258233171412, -30.076425134574507],
         [-57.54211983781764, -30.261565610297],
         [-57.33909461819662, -30.187090606642638],
         [-57.32330177151693, -30.247241144249994],
         [-57.357376554842126, -30.22438695294494],
         [-57.41522643887533, -30.101125261922817],
         [-57.08735320889486, -30.076097924752684],
         [-57.196873167390955, -30.015694341632816],
         [-57.17653129422201, -30.125941704834073],
         [-57.11936805569662, -30.04915077742337],
         [-57.555130461092126, -30.19688680167607],
         [-57.556675413484705, -30.18872626234997],
         [-57.210627403137515, -30.151373838550242],
         [-57.2204252968913, -30.230233535133422],
         [-57.48382351496055, -30.25302548790148],
         [-57.55892536737754, -30.19495569319407],
         [-57.18257795802095, -30.17846549480696],
         [-57.274845948133255, -29.992722957263087],
         [-57.39765795999671, -30.051453498911407],
         [-57.394482224523074, -30.053905137144636],
         [-57.325302689610965, -30.013779793105876],
         [-57.16840419107581, -30.02410990648716],
         [-57.39782962137366, -30.047070115661207],
         [-57.225910752355105, -29.99527207980065],
         [-57.19106349283362, -30.01786737669919],
         [-57.33519964755176, -30.01825910347735],
         [-57.34292440951465, -30.022420817230362],
         [-57.3291914993584, -30.00785405497967],
         [-57.17090185269042, -30.043723238454053],
         [-57.16017301663085, -30.029233915888614],
         [-57.162061291777334, -30.07700350114302],
         [-57.20188673123046, -30.01608023521208],
         [-57.18437727078124, -30.060364768278593],
         [-57.145324307524405, -30.109381582363792],
         [-57.13519628628417, -30.113836451498923],
         [-57.08009298428222, -30.06801596161276],
         [-57.15443560068167, -30.03841942902096],
         [-57.137870277805696, -30.126057875729693],
         [-57.187566246433626, -30.16591507203843],
         [-57.20698528536804, -30.203699871231585],
         [-57.22174816378601, -30.199397423444303],
         [-57.21659832247742, -30.19732031238302],
         [-57.21350841769226, -30.20340315673182],
         [-57.315990259733276, -30.15131591386597],
         [-57.22672634371765, -30.171649538284875],
         [-57.21634083041199, -30.173875592804972],
         [-57.21822910555847, -30.153245561945415],
         [-57.278053095426635, -30.163932160014944],
         [-57.3163056581744, -30.155828194952136],
         [-57.26369144613827, -30.21800038185985],
         [-57.30806591208065, -30.236614721333424],
         [-57.3133874147662, -30.22830915660127],
         [-57.201789230927886, -30.165375890452427],
         [-57.20419249020523, -30.161813871943803],
         [-57.21946051945512, -30.224721786744837],
         [-57.19199469914262, -30.234510771343437],
         [-57.210534127853556, -30.242964110069142],
         [-57.21740058293168, -30.222200223790747],
         [-57.1618947560535, -30.14893783935847],
         [-57.35638709614139, -30.231583971179358],
         [-57.36531348774295, -30.232177229311816],
         [-57.34007926533084, -30.200729616397055],
         [-57.54204603830836, -30.240855554565165],
         [-57.53191801706812, -30.257760413452516],
         [-57.53243300119898, -30.269918249995232],
         [-57.57894809944614, -30.19294547766426],
         [-57.57311161262973, -30.187010369495496],
         [-57.550023157429536, -30.184858804457395],
         [-57.57637317879184, -30.193019664252898],
         [-57.53678175252392, -30.174413164075823],
         [-57.55051466268017, -30.17634236012956],
         [-57.45824667256787, -30.172335526087917],
         [-57.45464178365185, -30.174338963473343],
         [-57.524378402536215, -30.182467923838256],
         [-57.33778248578817, -30.176235387957917],
         [-57.5332189634493, -30.179945278238225],
         [-57.51699696332723, -30.18217114535563],
         [-57.32928524762899, -30.170150865523354],
         [-57.33203182966024, -30.165698537948263],
         [-57.33684023022949, -30.170368325483384],
         [-57.205175954106444, -30.151370368402457],
         [-57.32842882275879, -30.201380557096076],
         [-57.318987447026366, -30.189065863649596],
         [-57.32277104495265, -30.207682632022507],
         [-57.336160632354996, -30.215248243349215],
         [-57.21598781178044, -30.150550920842086],
         [-57.19075358936833, -30.221478309988075],
         [-57.189909665471404, -30.165769312118883],
         [-57.13689024483656, -30.136634964546175],
         [-57.33052423437437, -30.014092444510023],
         [-57.414380817015974, -30.07679952387223],
         [-57.41669824560484, -30.07189732067436],
         [-57.195961781524176, -30.026525356932737],
         [-57.172787495635504, -30.02028297922486],
         [-57.18832285024976, -30.026673980182963],
         [-57.40281374075269, -30.097170563586403],
         [-57.30642587759351, -30.000810181548722],
         [-57.44375497915601, -30.10971948173039],
         [-57.43972093679761, -30.10660096448074],
         [-57.404959507964605, -30.09264068107573],
         [-57.30599672415113, -29.992782114283692],
         [-57.37114221670484, -30.038117301267306],
         [-57.31037408926343, -29.974121783405913],
         [-57.30247766592359, -29.99136970195114],
         [-57.182743855498785, -30.032618727471313],
         [-57.18368799307203, -30.03038948901985],
         [-57.31037408926343, -29.991146687640587],
         [-57.368738957427496, -30.03477361031284],
         [-57.17510492422437, -30.036111100233633],
         [-57.18119455617571, -30.03072325075291],
         [-57.191854552584985, -30.024169172993766],
         [-57.31974227841506, -29.995628703306394],
         [-57.29932582855059, -30.138986631673685],
         [-57.30190074920489, -30.134532897074955],
         [-57.162267284369655, -30.047228181525227],
         [-57.223460068839145, -30.174324472777737],
         [-57.19084440721805, -30.18441524327767],
         [-57.21693693651493, -30.159483227224293],
         [-57.16200529588993, -30.151319589826173],
         [-57.32491194261844, -30.21586806910058],
         [-57.18816434416097, -30.22970037045241],
         [-57.538980258295176, -30.230877948342155],
         [-57.488340152094004, -30.25134343198718],
         [-57.53258038406641, -30.265921771192584],
         [-57.45284466522764, -30.25734319168112],
         [-57.514612844173335, -30.176039432919858],
         [-57.543255370656055, -30.234556953163388],
         [-57.307821792164845, -30.215423037776716],
         [-57.34112409929375, -30.21126944820548],
         [-57.26679472307305, -30.244493254138156],
         [-57.18883787526092, -30.17177361634909],
         [-57.20308576954803, -30.184832401904956],
         [-57.18692026803567, -30.053337975868097],
         [-57.41882703259878, -30.092522860480774],
         [-57.41496465161733, -30.068384713509932],
         [-57.523115942652964, -30.265546199915796],
         [-57.5182807187497, -30.167214926601662],
         [-57.550381396239935, -30.193257788749836],
         [-57.449015353149115, -30.1761934429057],
         [-57.327337407166226, -30.207496830210356],
         [-57.28835312651565, -30.157860812621614]]),
    NonCrop1 = 
    /* color: #0b4a8b */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[-57.478479530852276, -30.219504438658667],
         [-57.4633733296804, -30.163715350044484],
         [-57.523060734922055, -30.236241870134954],
         [-57.3745736438576, -30.243063799259694],
         [-57.50778287237323, -30.182539735285346],
         [-57.37680524175799, -30.21725661930399],
         [-57.248402531797055, -30.212509733946735],
         [-57.231923039609555, -30.282503057785654],
         [-57.2068604785744, -30.18432038610751],
         [-57.4046143848244, -30.167106080031715],
         [-57.498341496640805, -30.175120010422408],
         [-57.377491887265805, -30.18194617785871],
         [-57.32599347417987, -30.14691996122492],
         [-57.196732457334164, -30.219778308992748],
         [-57.29818433111346, -30.199009527131846],
         [-57.104550297910336, -30.06449997347016],
         [-57.073651250058774, -30.080395301233917],
         [-57.172528203183774, -30.06464853975501],
         [-57.18334286993182, -30.097624734080664],
         [-57.13235944097674, -30.12465106863716],
         [-57.3496827441994, -30.067025569985237],
         [-57.373028691465024, -30.091089785361586],
         [-57.36556142156756, -30.107203594011647],
         [-57.17905133550799, -30.088416272751093],
         [-57.334061558896664, -30.132816912634482],
         [-57.45834439581073, -30.205092267103325],
         [-57.43105023687518, -30.111881304446097],
         [-57.15639203375018, -30.149295013187388],
         [-57.5254639941994, -30.188771872340176],
         [-57.17184155767596, -30.029877951560447],
         [-57.31062978094256, -30.03663985513297],
         [-57.23157971685565, -29.992716405919214],
         [-57.118283208066586, -30.09643659371656],
         [-57.236386235410336, -30.067322694750057],
         [-57.20377057378924, -30.04176670523547],
         [-57.17218488042987, -30.052762532372395],
         [-57.247372563535336, -30.11485116437738],
         [-57.266598637754086, -30.032255816398123],
         [-57.325306828672055, -30.09257503891016],
         [-57.30814069097674, -30.140388273503735],
         [-57.34521954839862, -30.111584313542426],
         [-57.21887677496112, -30.01144756506438],
         [-57.42831121912935, -30.116639580629727],
         [-57.39054571619966, -30.072083115769754],
         [-57.43019949427583, -30.0906507498178],
         [-57.1538246773813, -30.15716850483286],
         [-57.156742920789505, -30.138761825698822],
         [-57.20188986292818, -30.108472398843517],
         [-57.45079885951021, -30.202576738473358],
         [-57.10919271937349, -30.103720273303043],
         [-57.26998535918167, -30.23449306298756],
         [-57.26449219511917, -30.228560460316622],
         [-57.25968567656448, -30.225890672330227],
         [-57.25419251250198, -30.221440864618035],
         [-57.2332498245137, -30.232897471093512],
         [-57.219860237111355, -30.184683933896462],
         [-57.211620491017605, -30.189728917805553],
         [-57.299511116017605, -30.20712708819962],
         [-57.190162818898465, -30.213060983706665],
         [-57.289554756154324, -30.193774515164804],
         [-57.26449219511917, -30.174187465824783],
         [-57.357189338673855, -30.185465333529933],
         [-57.358219306935574, -30.189026497215433],
         [-57.36233917998245, -30.175374670585107],
         [-57.358219306935574, -30.158158801824488],
         [-57.35135285185745, -30.14836222429607],
         [-57.46224610136917, -30.171516202820456],
         [-57.38122193144729, -30.119263623326987],
         [-57.348949592580105, -30.098770687883604],
         [-57.30809418486526, -30.113324079502416],
         [-57.30191437529495, -30.10174094187806],
         [-57.297794502248074, -30.110057178168077],
         [-57.2497293167012, -30.117778770854425],
         [-57.17934815215042, -30.092235814917224],
         [-57.408344429005886, -30.243318283657633],
         [-57.4090310745137, -30.232936926084786],
         [-57.429630439748074, -30.229080714032975],
         [-57.536747138966824, -30.184871793731137],
         [-57.38070694731643, -30.257108962498176],
         [-57.41006104277542, -30.17448426835575],
         [-57.42345063017776, -30.126390604440697],
         [-57.37401215361526, -30.18724593146735],
         [-57.27788178252151, -30.060446410869304],
         [-57.26174561308792, -30.065794875663567],
         [-57.199604194630886, -30.063714951472186],
         [-57.097980659474636, -30.10263200067042],
         [-57.146732490529324, -30.036374743712706],
         [-57.24856202644361, -30.056226850214784],
         [-57.44889725432144, -30.215069849966685],
         [-57.404265296313625, -30.218036602954264],
         [-57.26624954924331, -30.25466862518601],
         [-57.24977005705581, -30.26875422883461],
         [-57.21715439543472, -30.259265202133136],
         [-57.12823010712407, -30.126991093742557],
         [-57.35482312470219, -30.025978200393546],
         [-57.39190198212407, -30.068178479717297],
         [-57.16891385346196, -30.060750157233308],
         [-57.2317419174268, -30.051092504652384],
         [-57.210970890815474, -30.060453012738755],
         [-57.237406742866256, -30.034300805183815],
         [-57.306071293647506, -30.078874284626643],
         [-57.31997586518071, -30.065355782844417],
         [-57.33697034149907, -30.06698998558287],
         [-57.358256352241256, -30.058670127042],
         [-57.35842801361821, -30.109766780359337],
         [-57.284098637397506, -30.096698056430082],
         [-57.27517224579594, -30.07426928813857],
         [-57.189513218696334, -30.092687987878577],
         [-57.23299825649015, -30.10892963026103],
         [-57.230080013081945, -30.132092861831694],
         [-57.10116231899015, -30.07788832671436],
         [-57.207744509235916, -30.154682761544557],
         [-57.19933310176521, -30.19890024715718],
         [-57.18096533443123, -30.18688200867605],
         [-57.19589987422615, -30.210471979224224],
         [-57.236755281940994, -30.26045215341511],
         [-57.19658651973396, -30.256300466071472],
         [-57.29357519771248, -30.274536927478977],
         [-57.3528350663125, -30.214773942903534],
         [-57.40107191323633, -30.211510401471173],
         [-57.394720442289064, -30.20691159118484],
         [-57.39660871743555, -30.268606742577585],
         [-57.409139997953126, -30.25585563201858],
         [-57.41858137368555, -30.24295456821873],
         [-57.44793861342439, -30.242228829676016],
         [-57.457551650533766, -30.21582807735933],
         [-57.55161148523006, -30.207192378486663],
         [-57.54834991906795, -30.172323540991925],
         [-57.34674914367124, -30.161874565892226],
         [-57.36288531310483, -30.146289231489042],
         [-57.417863643261796, -30.133387464854227],
         [-57.391577609333645, -30.116220951033828],
         [-57.35133132063115, -30.02938074455048],
         [-57.295540515332085, -29.99927972935573],
         [-57.26927632465826, -29.99496837413817],
         [-57.285069171337945, -29.97965411608526],
         [-57.180955882517694, -30.015408006693782],
         [-57.15263175532043, -30.044982960079913],
         [-57.10061835810363, -30.082867609948803],
         [-57.199666972605584, -30.027595739833224],
         [-57.08426019424726, -30.084910272943805],
         [-57.10468789810468, -30.08981183129159],
         [-57.090268342440616, -30.079117208964398],
         [-57.22882472989293, -30.138915536996095],
         [-57.25584932730903, -30.155520176738314],
         [-57.24628461500139, -30.277177943331278],
         [-57.458190188463995, -30.258058930172535],
         [-57.54429710587347, -30.177856043611044],
         [-57.44377279978704, -30.150193216303897],
         [-57.43706140005114, -30.161525875365736],
         [-57.51457849084375, -30.188829585650744],
         [-57.51234689294336, -30.190610122768327],
         [-57.50771203576563, -30.191055252017854],
         [-57.505823760619144, -30.1943194717025],
         [-57.50067391931055, -30.195209694655208],
         [-57.49518075524805, -30.195803172152242],
         [-57.49071755944727, -30.195358064364815],
         [-57.53071466027735, -30.18630710296413],
         [-57.541014342894535, -30.180371594761993],
         [-57.52195993005274, -30.187790924133058],
         [-57.41827645837305, -30.177997291347804],
         [-57.423426299681644, -30.182300674155144],
         [-57.50633874475, -30.176364924561195],
         [-57.502047210326175, -30.175029331621772],
         [-57.514063506712894, -30.193429240701317],
         [-57.428919463744144, -30.18630710296413],
         [-57.5034205013418, -30.188681206104565],
         [-57.37879434167383, -30.188681206104565],
         [-57.30738320886133, -30.209007121118496],
         [-57.31098809777735, -30.212122401358975],
         [-57.40034580758061, -30.103192291390727],
         [-57.396397595910685, -30.10942944261944],
         [-57.28018284371342, -30.03886729163487],
         [-57.281041150598185, -30.032328462289673],
         [-57.31228352120365, -30.015533583029335],
         [-57.49528286383843, -30.201103443601834],
         [-57.48910305426812, -30.20273540040923],
         [-57.47760174201226, -30.2073344058416],
         [-57.47193691657281, -30.210598085775505],
         [-57.492707943184136, -30.205109107466313],
         [-57.47880337165093, -30.212674916649156],
         [-57.40945217536187, -30.190420876426217],
         [-57.40430233405328, -30.194723716492195],
         [-57.420095180732964, -30.192794880402634],
         [-57.41649029181695, -30.185821080867264],
         [-57.36537363878983, -30.240542937642527],
         [-57.36228373400468, -30.242470837767296],
         [-57.37962153307694, -30.25092349185044],
         [-57.37790491930741, -30.253147753646516],
         [-57.34872248522538, -30.24024633426671],
         [-57.175194992003924, -30.22376893311142],
         [-57.187480333078895, -30.20280840931275],
         [-57.27482864801178, -30.171797958238084],
         [-57.26847717706451, -30.17194636321356],
         [-57.16307709161529, -30.169571856789982],
         [-57.27826027181422, -30.11933843257617],
         [-57.27517036702906, -30.113398893250157],
         [-57.28169349935328, -30.12438676017506],
         [-57.27602867391383, -30.098845512650517],
         [-57.269333880212656, -30.103300856796146]]),
    NonCrop2 = 
    /* color: #ffc82d */
    /* shown: false */
    ee.Geometry.MultiPoint(
        [[-57.49993720297142, -30.180633465261984],
         [-57.42011466268821, -30.13090968119851],
         [-57.4066279115904, -30.169326446322987],
         [-57.378990429900945, -30.17763698920849],
         [-57.459671277068914, -30.163389915216563],
         [-57.482330578826726, -30.223777425044087],
         [-57.52146937277204, -30.235791158329107],
         [-57.24921442892438, -30.213542346441326],
         [-57.22312189962751, -30.151218908891657],
         [-57.42506369677552, -30.13076341714126],
         [-57.37289947346958, -30.091084247402105],
         [-57.08897155598911, -30.089301913593644],
         [-57.325864256184424, -30.092569501033864],
         [-57.233682096760596, -30.067614279349282],
         [-57.2256140120438, -29.99543939919173],
         [-57.170510710041846, -30.034457585613875],
         [-57.49194663838657, -30.16811756942784],
         [-57.17222732381138, -30.173905414010843],
         [-57.150083006184424, -30.15624400412942],
         [-57.26612609700474, -30.02821570740806],
         [-57.48859924153599, -30.166135226611726],
         [-57.194028318684424, -30.2276435171504],
         [-57.1926550276688, -30.252261707742345],
         [-57.23282378987583, -30.281321028273215],
         [-57.38285583333286, -30.17838864480393],
         [-57.44980377034458, -30.24618188470667],
         [-57.23727200314494, -29.990069001298465],
         [-57.464698881740595, -30.166720457853618],
         [-57.441524595851924, -30.15603416199406],
         [-57.455944151515986, -30.15974481264891],
         [-57.43568810903552, -30.157963717760307],
         [-57.41337213003161, -30.166572045009556],
         [-57.410282225246455, -30.177108801637022],
         [-57.40513238393786, -30.175773218780122],
         [-57.444957823390986, -30.199662577074733],
         [-57.52993020498278, -30.19105714057086],
         [-57.514137358303095, -30.1848251481144],
         [-57.536110014553095, -30.18734766875364],
         [-57.5447275594352, -30.207792570875547],
         [-57.470743337970156, -30.224857772357247],
         [-57.52859322200336, -30.196820328809498],
         [-57.43984429011859, -30.243989852055485],
         [-57.37049309382953, -30.23657475919371],
         [-57.408086935382265, -30.257039056598003],
         [-57.44173256526508, -30.230938914494836],
         [-57.427827993731874, -30.22189122509625],
         [-57.37672702276467, -30.2206030138591],
         [-57.37449542486428, -30.211999408167447],
         [-57.29402307886602, -30.21497771429309],
         [-57.19617609400274, -30.234408338199383],
         [-57.30466608423711, -30.199549142268122],
         [-57.30294947046758, -30.21052741290063],
         [-57.29968790430547, -30.188272887148205],
         [-57.254884284920706, -30.2253609680345],
         [-57.26758722681524, -30.23722620148937],
         [-57.25076441187383, -30.217796134395662],
         [-57.23600153345586, -30.237671119888088],
         [-57.2746510486053, -30.262158349709605],
         [-57.2307057361053, -30.257710183833954],
         [-57.2113080005096, -30.259044654751197],
         [-57.207401461961666, -30.20717122406943],
         [-57.201221652391354, -30.20717122406943],
         [-57.17289752519409, -30.163249299354195],
         [-57.21152133500854, -30.19218655240387],
         [-57.22045450659292, -30.18926806925444],
         [-57.293067269044094, -30.19475793086225],
         [-57.19862192751522, -30.15321372083384],
         [-57.19930857302303, -30.16167404254689],
         [-57.20342844606991, -30.154698040300204],
         [-57.229692636743735, -30.133618610555892],
         [-57.22814768435116, -30.14846374842931],
         [-57.24166933939283, -30.123853842602003],
         [-57.250767392371344, -30.123556887696374],
         [-57.18587939188306, -30.09252017842534],
         [-57.176094693396735, -30.087767285899332],
         [-57.178414050584124, -30.095268841361204],
         [-57.17532414579897, -30.118435275943426],
         [-57.10373870204536, -30.09910035883345],
         [-57.09807387660591, -30.087069957559663],
         [-57.09532729457466, -30.097169652311653],
         [-57.164850152240675, -30.065381833964967],
         [-57.19763747523872, -30.06642178401044],
         [-57.19609252284614, -30.042648768201705],
         [-57.1471690304145, -30.042500168907186],
         [-57.175836480365675, -30.061221924518193],
         [-57.19132061071047, -30.031818565902928],
         [-57.19612712926516, -30.02840035218096],
         [-57.21621151036867, -30.014945533386058],
         [-57.244878960319845, -29.98268525343667],
         [-57.24573726720461, -29.98922735588443],
         [-57.22359294957766, -29.993092941083745],
         [-57.29036922521242, -30.02445808316873],
         [-57.34557521285325, -30.03162152994391],
         [-57.348665117638404, -30.060597357851748],
         [-57.389326891726355, -30.062843745424715],
         [-57.37628062707792, -30.092553061316266],
         [-57.34288356466921, -30.12523195172364],
         [-57.328464009005145, -30.1360700432871],
         [-57.32966563864382, -30.14215666874523],
         [-57.368084595720056, -30.187527747155585],
         [-57.3624197702806, -30.189456686410292],
         [-57.52884201533313, -30.201545800568127],
         [-57.51844022032249, -30.188667031797014],
         [-57.279355290849324, -30.157400185209127],
         [-57.34949306475499, -30.15004059308756],
         [-57.37673080383067, -30.124505981259993],
         [-57.37501419006114, -30.07656713357874],
         [-57.26026221897639, -30.047314267432125],
         [-57.23485633518733, -30.061578089860955],
         [-57.28086158421077, -30.066777930643468],
         [-57.255970684552565, -30.070343377868756],
         [-57.24258592072602, -29.984637625128897],
         [-57.13466077842849, -30.12710621911858],
         [-57.17412792455782, -30.16801136402889],
         [-57.216528284665245, -30.19086397540445],
         [-57.20652818819455, -30.257306119178267],
         [-57.23902104862998, -30.280497767636433],
         [-57.22202657231162, -30.281683689589393],
         [-57.42587668405923, -30.229771433676458],
         [-57.48369754652288, -30.16316765402962],
         [-57.30372020487588, -30.140296581718776],
         [-57.30646678690713, -30.114759448872928],
         [-57.2827775168876, -30.102879462455952],
         [-57.30166026835244, -30.103473495700225],
         [-57.38661693391876, -30.074743329583328],
         [-57.30348873211316, -30.018346888955136],
         [-57.228447435108656, -30.06223344946548],
         [-57.123390692388305, -30.123548973595504],
         [-57.11978580347229, -30.1180551463288],
         [-57.14021350732971, -30.144185215182787],
         [-57.14278842798401, -30.147302545568994],
         [-57.144848364507446, -30.15041977745359],
         [-57.15428974023987, -30.142552288528368],
         [-57.154633062993774, -30.16333297435537],
         [-57.15102817407776, -30.16021615061408],
         [-57.2054448305719, -30.192672004084365],
         [-57.19840671411682, -30.24411762714168],
         [-57.188107031499634, -30.25049415124891],
         [-57.170597571050415, -30.234032977017407],
         [-57.17025424829651, -30.226320487652295],
         [-57.383888849538835, -30.26313664268514],
         [-57.3902403204861, -30.26610194512544],
         [-57.49521094942823, -30.176522969811824],
         [-57.41391757180882, -30.175187379014535],
         [-57.354947800506174, -30.160674407305944],
         [-57.382413620818674, -30.125492159431598],
         [-57.42429899679524, -30.121928700747706],
         [-57.354947800506174, -30.111534545137957],
         [-57.347223038543284, -30.101584828958693],
         [-57.326280350555, -30.09772347526162],
         [-57.49518075524805, -30.177997291347804],
         [-57.49518075524805, -30.18096516167537],
         [-57.49552407800196, -30.183042617709795],
         [-57.49586740075586, -30.185120029934577],
         [-57.49518075524805, -30.187494161687564],
         [-57.49312081872461, -30.190164991506858],
         [-57.49123254357813, -30.191055252017854],
         [-57.488314300169925, -30.19446784275353],
         [-57.48470941125391, -30.198177046367928],
         [-57.47114816247461, -30.20544668008185],
         [-57.482306151976566, -30.200550863345708],
         [-57.47801461755274, -30.20203446988948],
         [-57.475096374144535, -30.202627906246157],
         [-57.46822991906641, -30.205891742255577],
         [-57.4620501094961, -30.206485155356532],
         [-57.43904748498438, -30.196693381690526],
         [-57.435614257445316, -30.19253900165181],
         [-57.43149438439844, -30.189423101600045],
         [-57.426172881712894, -30.184674873860263],
         [-57.42136636315821, -30.18096516167537],
         [-57.37837315133061, -30.114032801702724],
         [-57.39897251656498, -30.107053431429584],
         [-57.27640629342045, -30.053429497050875],
         [-57.2872209601685, -30.026235073906868],
         [-57.30867863228764, -30.01761451893061],
         [-57.4990594141314, -30.20229032396317],
         [-57.48206493781304, -30.208817910138645],
         [-57.47537014411187, -30.212674916649156],
         [-57.47210857794976, -30.21400999906314],
         [-57.47056362555718, -30.216680109542267],
         [-57.408078884346246, -30.192794880402634],
         [-57.47468349860406, -30.215345063361006],
         [-57.3837029688189, -30.180033936175896],
         [-57.38679287360406, -30.16994271695881],
         [-57.38576290534234, -30.172020405390082],
         [-57.368806866328896, -30.240542937642527],
         [-57.349580792110146, -30.238466695215084],
         [-57.341856030147255, -30.23668702394143],
         [-57.33670618883866, -30.231792761803316],
         [-57.33207133166093, -30.23194107635706],
         [-57.27740196492945, -30.10493443266041],
         [-57.27345375325953, -30.10731049480324],
         [-57.28341011312281, -30.128247071846364],
         [-57.28941826131617, -30.134482641089214],
         [-57.22109703328883, -30.13210723258384],
         [-57.19260124471461, -30.13210723258384],
         [-57.167023699548594, -30.13403725634877],
         [-57.15140251424586, -30.11740812147093],
         [-57.27997688558375, -30.11369587869874],
         [-57.26484581589673, -30.095083763051665]]),
    Point = 
    /* color: #98ff00 */
    /* shown: false */
    ee.Geometry.Polygon(
        [[[-57.40630430432272, -30.27978238018795],
          [-57.406185679980545, -30.28303449872451],
          [-57.40498937733522, -30.283261700069566],
          [-57.40405052661378, -30.283247969324524],
          [-57.40277380379803, -30.282849975103492],
          [-57.40157180216974, -30.282442558423448],
          [-57.39995145603529, -30.282767052155588],
          [-57.399001785044966, -30.282771813358963],
          [-57.397408469656376, -30.283443944725335],
          [-57.39590548972801, -30.284685403684932],
          [-57.395475679177245, -30.284054834909703],
          [-57.39470571729224, -30.28277362045735],
          [-57.39496574064241, -30.28160361150328],
          [-57.395378548086384, -30.279337699011506],
          [-57.39536809336777, -30.27812366908298],
          [-57.39496078447792, -30.275936503432213],
          [-57.3960770185151, -30.274916838650388],
          [-57.39873845435315, -30.273452188698975],
          [-57.399933006719934, -30.273266729446515],
          [-57.4006126303115, -30.27411918523687],
          [-57.40137089970357, -30.27508281494987],
          [-57.40310105336577, -30.27597275111846],
          [-57.40454437784776, -30.276714700687602],
          [-57.40622942672088, -30.27816077160141]]]);

/*---------------------------------------------------------------------------------------------*/
var Elevation = ee.Image("USGS/SRTMGL1_003");
var Ndwi = ee.ImageCollection("MODIS/MOD09GA_006_NDWI");
var NdviEvi = ee.ImageCollection("MODIS/006/MOD13Q1");
var Sentinel1 = ee.ImageCollection("COPERNICUS/S1_GRD");

var NdviEvi= NdviEvi.filterDate('2000-01-01','2019-12-31');
var Ndwi = Ndwi.filterDate('2000-01-01','2019-12-31');

var Year0 = 2000; 
var Year1 = 2001;
var Year2 = 2002;
var Year3 = 2003;
var Year4 = 2004; 
var Year5 = 2005;
var Year6 = 2006;
var Year7 = 2007;
var Year8 = 2008;
var Year9 = 2009;
var Year10= 2010; 
var Year11= 2011;
var Year12= 2012;
var Year13= 2013;
var Year14= 2014; 
var Year15= 2015;
var Year16= 2016;
var Year17= 2017;
var Year18= 2018;
var Year19= 2019;

/*============================================================================================================================*/
//Select years, months and other variables of interest
var aoi = RioGrandeDoSul2; //To change the area of interest
var Prj = NdviEvi.first().projection(); //To extract the projection
var Date1 = '2018-01-01'; //Start date
var Date2 = '2019-12-31'; //End date. This date corresponds to Date1 + 1
var YearCrop1 = Year18; //First year. This year correspons with the year in Date 1
var YearCrop2 = Year19; //Second year. This year corresponds to YearCrop1 + 1
var MonthHeading = 2; //To choose the month of heading phase 
var MonthSeeding = 10; //To choose the month of seeding phase
var NumberRicePoints = 150; //Select the number of training points as Rice
var NumberNonRicePoints=150; //Select the number of training points as Non-Rice
//Select the bands for classification year by year
var bands = ['NDVI', 'EVI', 'sur_refl_b01', 'sur_refl_b02', 'sur_refl_b03', 'sur_refl_b07', 'NDWI', 'elevation'];
//Select the bands for multiyear classification 
var bands2 = ['NDVI', 'EVI', 'sur_refl_b01', 'sur_refl_b02', 'sur_refl_b03', 'sur_refl_b07', 'NDWI', 'elevation','VH'];

var Semilla = 1; //Select seed
var NClusters = 5; //Select K number for previous cluster classification
var RiceMinPixel = 4000; //Select the minimum value of EVI for the range that corresponds heading phase
var RiceMaxPixel = 4500; //Select the maximum value of EVI for the range that corresponds heading phase
var SubMuestra = 0.8; //Select sumbsampling for trainig CART algorithm
var DataCollectForGraph =  NdviEvi; //Options: NdviEvi (for EVI and NDVI), Ndwi (for NDWI)
var NameGraph1 = 'EVI'; //To define a chart with one series in the extracted points as paddy rice, averaged by DOY
var BanPolS1 = 'VH'; //To select the band Polarisation of Sentinel-1; Options: VH, HV, HH and VV
var PassOrbit = 'DESCENDING'; //To select the orbitProperties_pass for Sentinel 1. Options:  DESCENDING or ASCENDING
var Date1SentinelH = '2016-10-01'; // Start date of Heading in Sentinel. Select from 2014-10-03T00:00:00 to 2020-11-10T00:00:00
var Date2SentinelH = '2016-10-30'; // End date of Heading in Sentinel. Select from 2014-10-03T00:00:00 to 2020-11-10T00:00:00
var Date1SentinelS = '2017-10-01'; // Start date of Seeding in Sentinel. Select from 2014-10-03T00:00:00 to 2020-11-10T00:00:00
var Date2SentinelS = '2017-11-30'; // End date of Seeding in Sentinel. Select from 2014-10-03T00:00:00 to 2020-11-10T00:00:00
var YearCropS1=Year16;//To extract multiyear seeding and heading phase. Start date.
var YearCropS2=Year19;//To extract multiyear seeding and heading phase. End date.
/*============================================================================================================================*/

//Filter Seeding and Heading phases

var sviSeeding = NdviEvi.filter(ee.Filter.calendarRange(YearCrop1, YearCrop1, 'year'))
                  .filter(ee.Filter.calendarRange(MonthSeeding,MonthSeeding, 'month')).mean();
                  
var sviHeading = NdviEvi.filter(ee.Filter.calendarRange(YearCrop2, YearCrop2, 'year'))
                  .filter(ee.Filter.calendarRange(MonthHeading,MonthHeading, 'month')).mean();

var NdwiSeeding = Ndwi.filter(ee.Filter.calendarRange(YearCrop1, YearCrop1, 'year'))
                  .filter(ee.Filter.calendarRange(MonthSeeding,MonthSeeding, 'month')).mean();
                  
var NdwiHeading = Ndwi.filter(ee.Filter.calendarRange(YearCrop2, YearCrop2, 'year'))
                  .filter(ee.Filter.calendarRange(MonthHeading,MonthHeading, 'month')).mean();

var SISeeding = sviSeeding.addBands(NdwiSeeding.select('NDWI'));
var SISeeding = SISeeding.addBands(Elevation.select('elevation'));
var SIHeading = sviHeading.addBands(NdwiHeading.select('NDWI'));
var SIHeading = SIHeading.addBands(Elevation.select('elevation'));


//Previous unsupervised classification as criterium to selec the range of pixels of paddy rice

// Make the training dataset.
var trainingPrev = SIHeading.select(bands).sample({
  region: aoi,
  scale: 250,
  numPixels: 5000
});

// Instantiate the clusterer and train it.
var clusterer = ee.Clusterer.wekaKMeans(NClusters).train(trainingPrev);

// Cluster the input using the trained clusterer.
var result = SIHeading.cluster(clusterer);

//Extract sample points

var HeadingAndSeeding = sviHeading.select('EVI').subtract(sviSeeding.select('EVI'));

//EVI range (4000-4500) to rice crops

var Rice = HeadingAndSeeding.gt(RiceMinPixel).and(HeadingAndSeeding.lt(RiceMaxPixel));
var SamplepointsRice = Rice.selfMask().stratifiedSample({numPoints:NumberRicePoints, region:aoi, geometries: true, projection:Prj, seed: Semilla});
var pointsRice = SamplepointsRice.map(function(feature) {
  return ee.Feature(feature.geometry(), {'class': 1});
});

var NonRice = HeadingAndSeeding.lt(RiceMinPixel);
var SamplepointsNonRice = NonRice.selfMask().stratifiedSample({numPoints:NumberNonRicePoints, region:aoi, geometries: true, projection:Prj, seed: Semilla});
var pointsNonRice = SamplepointsNonRice.map(function(feature) {
  return ee.Feature(feature.geometry(), {'class': 2});
});

// get coordinates image
var latlon = ee.Image.pixelLonLat().reproject(Prj);

//coordinates for Rice
var coordsRice = latlon.select(['longitude', 'latitude'])
                 .reduceRegion({
  reducer: ee.Reducer.toList(),
  geometry: pointsRice,
  scale: 250
});

// get lat & lon for Rice
var latRice = ee.List(coordsRice.get('latitude'));
var lonRice = ee.List(coordsRice.get('longitude'));

// zip them. Example: zip([1, 3],[2, 4]) --> [[1, 2], [3,4]] for Rice
var point_listRice = lonRice.zip(latRice);

// Create points for Rice
var mpRice = ee.Geometry.MultiPoint(point_listRice);

//coordinates for Non-rice
var coordsNonRice = latlon.select(['longitude', 'latitude'])
                 .reduceRegion({
  reducer: ee.Reducer.toList(),
  geometry: pointsNonRice,
  scale: 250
});

// get lat & lon for Non-rice
var latNonRice = ee.List(coordsNonRice.get('latitude'));
var lonNonRice = ee.List(coordsNonRice.get('longitude'));

// zip them. Example: zip([1, 3],[2, 4]) --> [[1, 2], [3,4]] for Non-rice
var point_listNonRice = lonNonRice.zip(latNonRice);

// Create points for Non-rice
var mpNonRice = ee.Geometry.MultiPoint(point_listNonRice);

var Points = ee.FeatureCollection([
  ee.Feature(mpRice,{'class':1}),
  ee.Feature(mpNonRice,{'class':2})
]);

// Define a chart with one series in the extracted points as paddy rice, averaged by year.

var chart = ui.Chart.image.series({
    imageCollection: DataCollectForGraph.filterDate(Date1,Date2).select(NameGraph1),
    region: mpRice
    }).setOptions({
      interpolateNulls: true,
      lineWidth: 1,
      pointSize: 3,
      title: NameGraph1+' over Time at a Paddy Rice Location',
      vAxis: {title: NameGraph1},
      hAxis: {title: 'Date', format: 'YYYY-MMM', gridlines: {count: 12}}
    });
print(chart);

//Filter Seeding and Heading phases in Sentinel Images

var Sentinel1 = Sentinel1
        .filter(ee.Filter.listContains('transmitterReceiverPolarisation', BanPolS1))
        .filter(ee.Filter.eq('instrumentMode', 'IW'))
        .select(BanPolS1)
        .map(function(image) {
          var edge = image.lt(-30.0);
          var maskedImage = image.mask().and(edge.not());
          return image.updateMask(maskedImage);
        });

var Sentinel1 = Sentinel1.filter(ee.Filter.eq('orbitProperties_pass', PassOrbit));

var SentinelHeading = ee.Filter.date(Date1SentinelH, Date2SentinelH);
var SentinelSeeding = ee.Filter.date(Date1SentinelS, Date2SentinelS);

//Concatenate seeging and heading phases with Sentinel-1
var SentinelChange = ee.Image.cat(
        Sentinel1.filter(SentinelSeeding).mean(),
        Sentinel1.filter(SentinelHeading).mean());

// Sentinel Chart and Multi-year chart of Spectral Index
var chartSentinel1 = ui.Chart.image.series({
    imageCollection: Sentinel1.filterDate('2015-01-01','2019-12-31'),
    region: Point
    }).setOptions({
      interpolateNulls: true,
      lineWidth: 1,
      pointSize: 3,
      title: 'VH'+' over Time at a Paddy Rice Location',
      vAxis: {title:'VH'},
      hAxis: {title: 'Date', format: 'YYYY-MMM', gridlines: {count: 12}}
    });
print(chartSentinel1);

var chart3 = ui.Chart.image.doySeries({
    imageCollection: DataCollectForGraph.filterDate('2000-01-01','2019-12-31').select(NameGraph1),
    region: crops1,regionReducer:ee.Reducer.mean(),scale:250
    }).setOptions({
      interpolateNulls: true,
      lineWidth: 1,
      pointSize: 3,
      title: NameGraph1+' over DOY at a Paddy Rice Location (2000-2019)',
      vAxis: {title: NameGraph1},
      hAxis: {title: 'DOY', gridlines: {count: 12}}
    });
print(chart3);


//Extract multiuyear seeding and heading phase with Sentinel-1
var SentiSeeding = Sentinel1.filter(ee.Filter.calendarRange(YearCropS1, YearCropS2, 'year'))
                  .filter(ee.Filter.calendarRange(MonthSeeding,MonthSeeding, 'month')).mean();

var SentiHeading = Sentinel1.filter(ee.Filter.calendarRange(YearCropS1, YearCropS2, 'year'))
                  .filter(ee.Filter.calendarRange(MonthHeading,MonthHeading, 'month')).mean();

//Apply difference between SentiSeeding and SentiHeading

var D = SentiSeeding.subtract(SentiHeading);

//Apply change detection and thresholding (CDTA) algorithm
var DMean = D.clip(aoi).reduce(ee.Reducer.mean());
var DStdDev= D.clip(aoi).reduce(ee.Reducer.stdDev());
var Filter = DMean.subtract(DStdDev.multiply(1.5));
var SentiSeedingClip = SentiSeeding.clip(aoi);
var Fp = SentiSeedingClip.mask(SentiSeedingClip.lt(Filter));

//Filter Seeding and Heading phases

var sviSeeding2 = NdviEvi.filter(ee.Filter.calendarRange(2000, 2019, 'year'))
                  .filter(ee.Filter.calendarRange(MonthSeeding,MonthSeeding, 'month')).mean();
                  
var sviHeading2 = NdviEvi.filter(ee.Filter.calendarRange(2000, 2019, 'year'))
                  .filter(ee.Filter.calendarRange(MonthHeading,MonthHeading, 'month')).mean();

var NdwiSeeding2 = Ndwi.filter(ee.Filter.calendarRange(2000, 2019, 'year'))
                  .filter(ee.Filter.calendarRange(MonthSeeding,MonthSeeding, 'month')).mean();
                  
var NdwiHeading2 = Ndwi.filter(ee.Filter.calendarRange(2000, 2019, 'year'))
                  .filter(ee.Filter.calendarRange(MonthHeading,MonthHeading, 'month')).mean();

var SISeeding2 = sviSeeding2.addBands(NdwiSeeding2.select('NDWI'));
var SISeeding2 = SISeeding2.addBands(Elevation.select('elevation'));
var SIHeading2 = sviHeading2.addBands(NdwiHeading2.select('NDWI'));
var SIHeading2 = SIHeading2.addBands(Elevation.select('elevation'));

//Prepare the second set of band to make the multuyear classification

var SISeeding2 = SISeeding2.addBands(Fp.select('VH'));
var SIHeading2 = SIHeading2.addBands(Fp.select('VH'));

var TrainigPoints = ee.FeatureCollection([
  ee.Feature(crops1,{'class':1}),
  ee.Feature(NonCrop1,{'class':2})
]);

var ValidatingPoints = ee.FeatureCollection([
  ee.Feature(crops2,{'class':1}),
  ee.Feature(NonCrop2,{'class':2})
]);


/*============================================================================================================================*/

//Classification CART year by year

var imageCl = SIHeading.select(bands);

// Overlay the training points on the imagery to get a training sample; include
// the crop classification property ('class') in the sample feature collection.
var training = imageCl
                   .sampleRegions({
                     collection: Points,
                     properties: ['class'],
                     scale: 250,
                   });

// Train a CART classifier with default parameters.
var trainedCart = ee.Classifier.smileCart().train(
    {features: training, classProperty: 'class', inputProperties: bands, subsampling: SubMuestra, subsamplingSeed: Semilla});

var classifiedCart = imageCl.select(bands).classify(trainedCart);

// Calculate the training error matrix and accuracy for both classifiers by
// using the "confusionMatrix" function to generate metrics on the
// resubstitution accuracy.
var trainAccuracyCart = trainedCart.confusionMatrix();

// Print model accuracy results.
print('##### TRAINING ACCURACY #####');
print('CART: overall accuracy:', trainAccuracyCart.accuracy());
print('CART: error matrix:', trainAccuracyCart);


// Classify the validation data.
var validatedCart = training.classify(trainedCart);
// Calculate the validation error matrix and accuracy for both classifiers by
// using the "confusionMatrix" function to generate metrics on the
// resubstitution accuracy.

var validationAccuracyCart = validatedCart.errorMatrix('class', 'classification');

// Print validation accuracy results.
print('##### VALIDATION ACCURACY #####');
print('CART: overall accuracy:', validationAccuracyCart.accuracy());
print('CART: error matrix:', validationAccuracyCart);


// Calculate area of each class (based on RF) in square meters.
var areaImage = ee.Image.pixelArea().addBands(classifiedCart);
var areas = areaImage.reduceRegion({
  reducer: ee.Reducer.sum().group({
    groupField: 1,
    groupName: 'class',
  }),
  geometry: aoi,
  scale: 250,
  maxPixels: 1e13,
  tileScale: 8
});

// Print the area calculations.
print('##### CLASS AREA SQ. METERS #####');
print(areas);

/*============================================================================================================================*/

//Classification CART year by year

var imageCl2 = SIHeading2.select(bands2);

// Overlay the training points on the imagery to get a training sample; include
// the crop classification property ('class') in the sample feature collection.
var training2 = imageCl2
                   .sampleRegions({
                     collection: TrainigPoints,
                     properties: ['class'],
                     scale: 250,
                   });

// Train a CART classifier with default parameters.
var trainedCart2 = ee.Classifier.smileCart().train(
    {features: training2, classProperty: 'class', inputProperties: bands2, subsampling: SubMuestra, subsamplingSeed: Semilla});

var classifiedCart2 = imageCl2.select(bands2).classify(trainedCart2);

// Calculate the training error matrix and accuracy for both classifiers by
// using the "confusionMatrix" function to generate metrics on the
// resubstitution accuracy.
var trainAccuracyCart2 = trainedCart2.confusionMatrix();

// Print model accuracy results.
print('##### TRAINING ACCURACY #####');
print('CART: overall accuracy multi-year: ', trainAccuracyCart2.accuracy());
print('CART: error matrix multi-year: ', trainAccuracyCart2);


// Classify the validation data.

var validating2 = imageCl2
                   .sampleRegions({
                     collection: ValidatingPoints,
                     properties: ['class'],
                     scale: 250,
                   });
                   
var validatedCart2 = validating2.classify(trainedCart2);
// Calculate the validation error matrix and accuracy for both classifiers by
// using the "confusionMatrix" function to generate metrics on the
// resubstitution accuracy.

var validationAccuracyCart2 = validatedCart2.errorMatrix('class', 'classification');

// Print validation accuracy results.
print('##### VALIDATION ACCURACY MULTI-YEAR#####');
print('CART: overall accuracy multi-year: ', validationAccuracyCart2.accuracy());
print('CART: error matrix multi-year: ', validationAccuracyCart2);


// Calculate area of each class (based on RF) in square meters.
var areaImage2 = ee.Image.pixelArea().addBands(classifiedCart2);
var areas2 = areaImage2.reduceRegion({
  reducer: ee.Reducer.sum().group({
    groupField: 1,
    groupName: 'class',
  }),
  geometry: aoi,
  scale: 250,
  maxPixels: 1e13,
  tileScale: 8
});

// Print the area calculations.
print('##### CLASS AREA SQ. METERS MULTI-YEAR#####');
print(areas2);


/*============================================================================================================================*/

//Visualization of maps
//Map.addLayer(result.clip(aoi).randomVisualizer(), {}, 'clusters');
//Map.addLayer(SISeeding.clip(aoi),{},'Seeding');
//Map.addLayer(SIHeading.subtract(SISeeding).clip(aoi),{},'Heading');
//Map.addLayer(pointsRice, {color: 'green'}, 'Rice points');
//Map.addLayer(pointsNonRice, {color: 'red'}, 'Non-rice points');
//Map.addLayer(classifiedCart.clip(aoi), {min:1,max:2, palette: ["00ff00","000000"]}, 'Classes (CART)');
//Map.addLayer(SentinelChange.clip(aoi), {min: -19.5, max: -16.6}, 'Multi-T Mean', true);
Map.addLayer(SIHeading2.subtract(SISeeding2).clip(aoi),{bands:"EVI", palette:["ff0000","00ff00","0000ff","00ffff","ff00ff","ffff00"]},'Multiyear 2000-2020 SI');
//Map.addLayer(Fp,{},'Flooded Zones');
Map.addLayer(classifiedCart2.clip(aoi), {min:1,max:2, palette: ["00ff00","000000"]}, 'Classes (CART)-multi-year');
Map.setCenter(-57.37580654547906,-30.18389207041158,10);

/*============================================================================================================================*/

/*
---------------
YEAR 2000-2001
---------------

RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9885057471264368
ERROR-MATRIX: [[112,2],[1,146]]
          RICE NON-RICE
RICE      112  2
NON-RICE  1    146
AREA-RICE(SQ. METERS): 140811114.93691787
AREA-NON-RICE(SQ. METERS): 858618728.1412686

---------------
YEAR 2001-2002
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9640287769784173
ERROR-MATRIX: [[125,3],[7,143]]
          RICE NON-RICE
RICE      125  3
NON-RICE  7    143
AREA-RICE(SQ. METERS): 145512844.99992338
AREA-NON-RICE(SQ. METERS): 856609248.0274818

---------------
YEAR 2002-2003
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9662162162162162
ERROR-MATRIX: [[143,3],[10,140]]
          RICE NON-RICE
RICE      143  3
NON-RICE  10    140
AREA-RICE(SQ. METERS): 289205580.85906875
AREA-NON-RICE(SQ. METERS): 713724416.0316178

---------------
YEAR 2003-2004
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9628378378378378
ERROR-MATRIX: [[144,3],[8,141]]
          RICE NON-RICE
RICE      144  3
NON-RICE  8    141
AREA-RICE(SQ. METERS): 203867648.11043203
AREA-NON-RICE(SQ. METERS): 795452908.2841606

---------------
YEAR 2004-2005
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.98
ERROR-MATRIX: [[146,4],[2,148]]
          RICE NON-RICE
RICE      146  4
NON-RICE  2    148
AREA-RICE(SQ. METERS): 195055853.44633886
AREA-NON-RICE(SQ. METERS): 7807550956.7295039

---------------
YEAR 2005-2006
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9628378378378378
ERROR-MATRIX: [[144,2],[9,141]]
          RICE NON-RICE
RICE      144  2
NON-RICE  9    141
AREA-RICE(SQ. METERS): 126008412.32921259
AREA-NON-RICE(SQ. METERS): 876059598.0575674

---------------
YEAR 2006-2007
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.976027397260274
ERROR-MATRIX: [[140,3],[4,145]]
          RICE NON-RICE
RICE      140  3
NON-RICE  4    145
AREA-RICE(SQ. METERS): 145379766.80713847
AREA-NON-RICE(SQ. METERS): 856311023.931204

---------------
YEAR 2007-2008
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9627118644067797
ERROR-MATRIX: [[144,2],[9,140]]
          RICE NON-RICE
RICE      145  5
NON-RICE  2    147
AREA-RICE(SQ. METERS): 200194075.8285386
AREA-NON-RICE(SQ. METERS): 801658744.7926166

---------------
YEAR 2008-2009
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9728813559322034
ERROR-MATRIX: [[140,5],[3,147]]
          RICE NON-RICE
RICE      140  5
NON-RICE  3    147
AREA-RICE(SQ. METERS): 159657547.11773887
AREA-NON-RICE(SQ. METERS): 843056768.9057599

---------------
YEAR 2009-2010
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9864864864864865
ERROR-MATRIX: [[146,1],[3,146]]
          RICE NON-RICE
RICE      146  1
NON-RICE  3   146
AREA-RICE(SQ. METERS): 182327543.45625
AREA-NON-RICE(SQ. METERS): 818609609.0867801

---------------
YEAR 2010-2011
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9632107023411371
ERROR-MATRIX: [[145,5],[6,143]]
          RICE NON-RICE
RICE      145  5
NON-RICE  6    143
AREA-RICE(SQ. METERS): 211542284.5519761
AREA-NON-RICE(SQ. METERS): 790903016.959804

---------------
YEAR 2011-2012
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9663299663299664
ERROR-MATRIX: [[142,6],[4,145]]
          RICE NON-RICE
RICE      142  6
NON-RICE  4    145
AREA-RICE(SQ. METERS): 172695312.10010725
AREA-NON-RICE(SQ. METERS): 829803765.8101103

---------------
YEAR 2012-2013
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9796610169491525
ERROR-MATRIX: [[145,3],[3,144]]
          RICE NON-RICE
RICE      145  3
NON-RICE  3    144
AREA-RICE(SQ. METERS): 147659933.33486518
AREA-NON-RICE(SQ. METERS): 850745474.6886336

---------------
YEAR 2013-2014
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9663299663299664
ERROR-MATRIX: [[144,3],[7,143]]
          RICE NON-RICE
RICE      144  3
NON-RICE  7    143
AREA-RICE(SQ. METERS): 153796501.29580268
AREA-NON-RICE(SQ. METERS): 848218089.3605088

---------------
YEAR 2014-2015
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9865319865319865
ERROR-MATRIX: [[148,0],[4,145]]
          RICE NON-RICE
RICE      148  0
NON-RICE  4    145
AREA-RICE(SQ. METERS): 133203611.41407779
AREA-NON-RICE(SQ. METERS): 866117463.0391088

---------------
YEAR 2015-2016
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.979933110367893
ERROR-MATRIX: [[141,8],[4,146]]
          RICE NON-RICE
RICE      141  8
NON-RICE  4    146
AREA-RICE(SQ. METERS): 220071481.843842
AREA-NON-RICE(SQ. METERS): 781727234.4335632

---------------
YEAR 2016-2017
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9730639730639731
ERROR-MATRIX: [[144,3],[5,145]]
          RICE NON-RICE
RICE      144  3
NON-RICE  5    145
AREA-RICE(SQ. METERS): 201094739.73644298
AREA-NON-RICE(SQ. METERS): 801619537.9393996

---------------
YEAR 2017-2018
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9766666666666667
ERROR-MATRIX: [[145,5],[2,148]]
          RICE NON-RICE
RICE      145  5
NON-RICE  2    148
AREA-RICE(SQ. METERS): 221482910.45438114
AREA-NON-RICE(SQ. METERS): 780746801.3581803

---------------
YEAR 2018-2019
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.9662162162162162
ERROR-MATRIX: [[147,3],[7,142]]
          RICE NON-RICE
RICE      144  3
NON-RICE  7    142
AREA-RICE(SQ. METERS): 195180195.29613972
AREA-NON-RICE(SQ. METERS): 807695966.3328278

---------------
YEAR 2000-2019
---------------
RANGE OF EVI: (MIN-MAX) (4000-4500)
SEEDING MONTH: 10
HEADING MONTH: 2
NUMBER OF POINTS FOR TRAINING = (PADDY RICE - NON-PADDY RICE) (150-200)
%TRAINING: 80%
ACCURACY: 0.8314285714285714
ERROR-MATRIX: [[114,36],[23,177]]
          RICE NON-RICE
RICE      114  36
NON-RICE  23   177
AREA-RICE(SQ. METERS): 340570514.8402116
AREA-NON-RICE(SQ. METERS): 662359482.0504749
*/